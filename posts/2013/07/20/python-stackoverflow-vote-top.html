<!DOCTYPE html>
<html lang="en">

<!--[if IE 8]> <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->

<head>
    <meta name="google-site-verification" content="SzE6WCs23qFevgBzRIuG9vcfLU0lW_Vd5hFT-cJOLBE" />
    <title>[翻译整理]stackoverflow python 百问</title>
    <meta charset="utf-8" />
    <meta name="description" content="">
    <meta name="keywords" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

        <link rel="shortcut icon" href="/favicon.ico"/>
        <link rel="stylesheet" href="/theme/css/styles.css" media="all" />
        <link rel="stylesheet" href="/theme/css/tab.min.css" media="all" />
        <link rel="stylesheet" href="/theme/css/jquery-ui.min.css" media="all" />

        <link rel="stylesheet" href="/theme/css/font-awesome.min.css">
        <!--
        <link rel="stylesheet" href="http://apps.bdimg.com/libs/fontawesome/4.2.0/css/font-awesome.min.css">
        -->
        <!--[if IE 7]>
            <link rel="stylesheet" href="/theme/css/font-awesome-ie7.min.css">
        <![endif]-->

        <link href="/" type="application/atom+xml" rel="alternate" title="wklken's blog ATOM Feed" />
        <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="wklken's blog RSS Feed" />

</head>

<body>
    <div id="page" class="row">
        <div class="large-9 large-centered columns">

        <header id="header">
            <div class="constraint">
                <div class="o">
                    <a href="/"><h1 class="banner">Wklken <span class="blue"> Building </span></h1></a>

                <div class="social">
                            <a href="https://github.com/wklken" target='_blank'><i class="icon-github-sign icon-2x"></i></a>
                            <a href="http://weibo.com/wklken" target='_blank'><i class="icon-weibo icon-2x"></i></a>
                            <a href="mailto:wklken@yeah.net"><i class="icon-envelope icon-2x"></i></a>
                            <a href="http://www.wklken.me/feed.xml" target='_blank'><i class="icon-rss-sign icon-2x"></i></a>
                </div>
                <div class="nav">
                            <a href="/">首页</a>
                            <a href="/categories.html">分类</a>
                            <a href="/archives.html">归档</a>
                            <a href="/pages/projects.html">项目</a>
                            <a href="/pages/aboutme.html">关于</a>

                </div>

                </div>
            </div>
        </header><!-- /#banner -->

        <section id="main">


<article id="article">
    <section id="header">
        <!--
        <div class="meta">2013年07月20日</div>
        <h1 id="title"> [翻译整理]stackoverflow python 百问 </h1>
        -->
        <div class="meta"> &nbsp; </div>
        <h1> [翻译整理]stackoverflow python 百问 </h1>
    </section>

        <section id="toc">
            <div id="toc"><ul><li><a class="toc-href" href="#" title="[翻译整理]stackoverflow python 百问">[翻译整理]stackoverflow python 百问</a><ul><li><a class="toc-href" href="#_1" title="基本数据结构(列表，元组，字典等)">基本数据结构(列表，元组，字典等)</a><ul><li><a class="toc-href" href="#_2" title="判断一个列表为空得最佳实践">判断一个列表为空得最佳实践</a></li><li><a class="toc-href" href="#stringjoinlistlistjoinstring" title="为什么是string.join(list)而不是list.join(string)">为什么是string.join(list)而不是list.join(string)</a></li><li><a class="toc-href" href="#_3" title="如何合并两个列表">如何合并两个列表</a></li><li><a class="toc-href" href="#_4" title="如何扁平一个二维数组">如何扁平一个二维数组</a></li><li><a class="toc-href" href="#_5" title="如何获取一个列表的长度">如何获取一个列表的长度</a></li><li><a class="toc-href" href="#python" title="Python中如何复制一个列表">Python中如何复制一个列表</a></li><li><a class="toc-href" href="#appendextend" title="列表的append和extend的区别">列表的append和extend的区别</a></li><li><a class="toc-href" href="#_6" title="如何随机地从列表中抽取变量">如何随机地从列表中抽取变量</a></li><li><a class="toc-href" href="#_7" title="如何利用下标从列表中删除一个元素">如何利用下标从列表中删除一个元素</a></li><li><a class="toc-href" href="#_8" title="获取列表的最后一个元素">获取列表的最后一个元素</a></li><li><a class="toc-href" href="#_9" title="序列的切片操作">序列的切片操作</a></li><li><a class="toc-href" href="#_10" title="如何将一个列表切分成若干个长度相同的子序列">如何将一个列表切分成若干个长度相同的子序列</a></li><li><a class="toc-href" href="#_11" title="使用列表解析创建一个字典">使用列表解析创建一个字典</a></li><li><a class="toc-href" href="#inhas_key" title='使用"in"还是"has_key()"'>使用"in"还是"has_key()"</a></li><li><a class="toc-href" href="#_12" title="字典默认值">字典默认值</a></li><li><a class="toc-href" href="#_13" title="如何给字典添加一个值">如何给字典添加一个值</a></li><li><a class="toc-href" href="#object-" title="如何将字段转换成一个object，然后使用对象-属性的方式读取">如何将字段转换成一个object，然后使用对象-属性的方式读取</a></li></ul></li><li><a class="toc-href" href="#_15" title="字符串，文件">字符串，文件</a><ul><li><a class="toc-href" href="#_16" title="字符如何转为小写">字符如何转为小写</a></li><li><a class="toc-href" href="#_17" title="如何创建不存在的目录结构">如何创建不存在的目录结构</a></li><li><a class="toc-href" href="#_18" title="如何拷贝一个文件">如何拷贝一个文件</a></li><li><a class="toc-href" href="#floatint" title="字符串转为float/int">字符串转为float/int</a></li><li><a class="toc-href" href="#_19" title="如何反向输出一个字符串">如何反向输出一个字符串</a></li><li><a class="toc-href" href="#_20" title="如何随机生成大写字母和数字组成的字符串">如何随机生成大写字母和数字组成的字符串</a></li><li><a class="toc-href" href="#perl-chomp-line" title="逐行读文件去除换行符(perl chomp line)">逐行读文件去除换行符(perl chomp line)</a></li><li><a class="toc-href" href="#pythoncontains" title="python中字符串的contains">python中字符串的contains</a></li><li><a class="toc-href" href="#_21" title="如何判断一个字符串是数字">如何判断一个字符串是数字</a></li><li><a class="toc-href" href="#0" title="如何填充0到数字字符串中保证统一长度">如何填充0到数字字符串中保证统一长度</a></li></ul></li><li><a class="toc-href" href="#_23" title="控制结构（条件、循环）">控制结构（条件、循环）</a><ul><li><a class="toc-href" href="#_24" title="如何在循环中获取下标">如何在循环中获取下标</a></li><li><a class="toc-href" href="#_25" title="如何判断一个变量的类型">如何判断一个变量的类型</a></li></ul></li><li><a class="toc-href" href="#_27" title="类">类</a><ul><li><a class="toc-href" href="#_28" title="如何判断一个对象是否拥有某个属性">如何判断一个对象是否拥有某个属性</a></li><li><a class="toc-href" href="#python_1" title="Python中的类变量(环境变量)">Python中的类变量(环境变量)</a></li><li><a class="toc-href" href="#static-method" title="如何定义静态方法(static method)">如何定义静态方法(static method)</a></li><li><a class="toc-href" href="#staticmethodclassmethod" title="@staticmethod和@classmethod的区别">@staticmethod和@classmethod的区别</a></li><li><a class="toc-href" href="#_29" title="如何获取一个实例的类名">如何获取一个实例的类名</a></li></ul></li><li><a class="toc-href" href="#_31" title="模块">模块</a><ul><li><a class="toc-href" href="#_32" title="如何列出一个目录的所有文件">如何列出一个目录的所有文件</a></li><li><a class="toc-href" href="#jsonsimplejson" title="json和simplejson的区别">json和simplejson的区别</a></li><li><a class="toc-href" href="#python_2" title="python中如何获取当前时间">python中如何获取当前时间</a></li></ul></li><li><a class="toc-href" href="#_34" title="其他">其他</a><ul><li><a class="toc-href" href="#stdin" title="如何从标准输入读取内容stdin">如何从标准输入读取内容stdin</a></li><li><a class="toc-href" href="#foo-is-none-foo-none" title="foo is None 和 foo == None的区别">foo is None 和 foo == None的区别</a></li><li><a class="toc-href" href="#__init__py" title="__init__.py是做什么用的">__init__.py是做什么用的</a></li><li><a class="toc-href" href="#python_3" title="如何获取安装的python模块列表">如何获取安装的python模块列表</a></li></ul></li><li><a class="toc-href" href="#_36" title="环境相关">环境相关</a><ul><li><a class="toc-href" href="#setuppy" title="setup.py安装后如何卸载">setup.py安装后如何卸载</a></li></ul></li><li><a class="toc-href" href="#_38" title="异常">异常</a><ul><li><a class="toc-href" href="#_39" title="如何一行内处理多个异常">如何一行内处理多个异常</a></li><li><a class="toc-href" href="#flush-pythonprint" title="如何flush Python的print输出">如何flush Python的print输出</a></li><li><a class="toc-href" href="#_40" title="如何获取一个函数的函数名字符串">如何获取一个函数的函数名字符串</a></li><li><a class="toc-href" href="#python3python2python3" title="应该在学习Python3之前学习Python2，还是直接学习Python3">应该在学习Python3之前学习Python2，还是直接学习Python3</a></li><li><a class="toc-href" href="#pythonis" title="python中用==比较字符串，is有时候会返回错误判断">python中用==比较字符串，is有时候会返回错误判断</a></li><li><a class="toc-href" href="#_41" title="如何截取一个字符串获得子串">如何截取一个字符串获得子串</a></li><li><a class="toc-href" href="#_42" title="用函数名字符串调用一个函数">用函数名字符串调用一个函数</a></li><li><a class="toc-href" href="#_43" title="如何获取文件扩展名">如何获取文件扩展名</a></li><li><a class="toc-href" href="#list" title="如何获取list中包含某个元素所在的下标">如何获取list中包含某个元素所在的下标</a></li><li><a class="toc-href" href="#tab" title="如何截掉空格（包括tab)">如何截掉空格（包括tab)</a></li><li><a class="toc-href" href="#_44" title="如何将一个十六进制字符串转为整数">如何将一个十六进制字符串转为整数</a></li><li><a class="toc-href" href="#python_4" title="如何结束退出一个python脚本">如何结束退出一个python脚本</a></li><li><a class="toc-href" href="#_45" title="如何往文件中追加文本">如何往文件中追加文本</a></li><li><a class="toc-href" href="#_46" title="如何使用不同分隔符切分字符串">如何使用不同分隔符切分字符串</a></li><li><a class="toc-href" href="#ascii" title="如何获取一个字符的ASCII码">如何获取一个字符的ASCII码</a></li><li><a class="toc-href" href="#dictdict" title="排序一个列表中的所有dict，根据dict内值">排序一个列表中的所有dict，根据dict内值</a></li><li><a class="toc-href" href="#_47" title="读文件到列表中">读文件到列表中</a></li><li><a class="toc-href" href="#http" title="如何用http下载一个文件">如何用http下载一个文件</a></li><li><a class="toc-href" href="#virtualenvpython" title="在virtualenv中如何使用不同的python版本">在virtualenv中如何使用不同的python版本</a></li><li><a class="toc-href" href="#python_5" title="python中如何将一行长代码切成多行">python中如何将一行长代码切成多行</a></li><li><a class="toc-href" href="#txt" title="如何找到一个目录下所有.txt文件">如何找到一个目录下所有.txt文件</a></li><li><a class="toc-href" href="#import" title="如何使用绝对路径import一个模块">如何使用绝对路径import一个模块</a></li><li><a class="toc-href" href="#list_1" title="如何在遍历一个list时删除某些玄素">如何在遍历一个list时删除某些玄素</a></li><li><a class="toc-href" href="#_48" title="如何强制使用浮点数除法">如何强制使用浮点数除法</a></li><li><a class="toc-href" href="#_49" title="如何映射两个列表成为一个字典">如何映射两个列表成为一个字典</a></li><li><a class="toc-href" href="#_50" title="找到当前目录及文件所在目录">找到当前目录及文件所在目录</a></li><li><a class="toc-href" href="#1-in-10-truefalse" title="为何1 in [1,0] == True执行结果是False">为何1 in [1,0] == True执行结果是False</a></li><li><a class="toc-href" href="#pythonswitch" title="Python中的switch替代语法">Python中的switch替代语法</a></li><li><a class="toc-href" href="#datetime" title="如何将字符串转换为datetime">如何将字符串转换为datetime</a></li><li><a class="toc-href" href="#python_6" title="Python中有没有简单优雅的方式定义单例类">Python中有没有简单优雅的方式定义单例类</a></li><li><a class="toc-href" href="#_51" title="将一个字符串转为一个字典">将一个字符串转为一个字典</a></li><li><a class="toc-href" href="#pythonlisttuple" title="Python如何检查一个对象是list或者tuple，但是不是一个字符串">Python如何检查一个对象是list或者tuple，但是不是一个字符串</a></li><li><a class="toc-href" href="#if-x-is-not-none-if-not-x-is-none" if="" is="" none'="" none''="" not="" title="使用 " x="" 还是'if="">使用 'if x is not None' 还是'if not x is None'</a></li><li><a class="toc-href" href="#_52" title="如何获取一个文件的创建和修改时间">如何获取一个文件的创建和修改时间</a></li><li><a class="toc-href" href="#virtualenv" title="如何离开virtualenv">如何离开virtualenv</a></li><li><a class="toc-href" href="#_53" title="如何认为地抛出一个异常">如何认为地抛出一个异常</a></li><li><a class="toc-href" href="#python_7" title="在Python中如何展示二进制字面值">在Python中如何展示二进制字面值</a></li><li><a class="toc-href" href="#python_8" title="Python中检查类型的权威方法">Python中检查类型的权威方法</a></li><li><a class="toc-href" href="#pythonsite-packages" title="如何获取Python的site-packages目录位置">如何获取Python的site-packages目录位置</a></li><li><a class="toc-href" href="#python_9" title="Python中*和的作用">Python中*和的作用</a></li><li><a class="toc-href" href="#vs-format" title="字符串格式化 % vs format">字符串格式化 % vs format</a></li><li><a class="toc-href" href="#python_10" title="Python中什么项目结构更好">Python中什么项目结构更好</a></li><li><a class="toc-href" href="#argparse" title="argparse可选位置参数">argparse可选位置参数</a></li><li><a class="toc-href" href="#python-new-__init__" title="Python中 new 和 __init__的用法">Python中 new 和 __init__的用法</a></li><li><a class="toc-href" href="#python-self" self'="" title="Python " 解释'="">Python 'self' 解释</a></li><li><a class="toc-href" href="#pythonprivate" private'方法并不是真正的私有方法'="" title="为什么Python的">为什么Python的'private'方法并不是真正的私有方法</a></li><li><a class="toc-href" href="#python_11" title="Python中类方法的作用是什么">Python中类方法的作用是什么</a></li><li><a class="toc-href" href="#list_2" title="如何删除一个list中重复的值同时保证原有顺序">如何删除一个list中重复的值同时保证原有顺序</a></li><li><a class="toc-href" href="#_54" title="有什么方法可以获取系统当前用户名么?">有什么方法可以获取系统当前用户名么?</a></li><li><a class="toc-href" href="#python-assert" title="Python assert最佳实践">Python assert最佳实践</a></li><li><a class="toc-href" href="#_55" title="在非创建全局变量的地方使用全局变量">在非创建全局变量的地方使用全局变量</a></li><li><a class="toc-href" href="#python_12" title="如何在单一表达式中合并两个Python字典">如何在单一表达式中合并两个Python字典</a></li><li><a class="toc-href" href="#pip" title="如何使用 pip 更新所有包">如何使用 pip 更新所有包</a></li><li><a class="toc-href" href="#pythonexception" title="Python中声明exception的方法">Python中声明exception的方法</a></li><li><a class="toc-href" href="#pythoncounter" title="在Python中使用Counter错误">在Python中使用Counter错误</a></li><li><a class="toc-href" href="#python-easy_install" title="如何删除Python easy_install安装的包">如何删除Python easy_install安装的包</a></li><li><a class="toc-href" href="#pythonxml" title="在Python中如何解析xml">在Python中如何解析xml</a></li><li><a class="toc-href" href="#python-timestruct_timedatetime" title="如何将一个Python time.struct_time对象转换为一个datetime对象">如何将一个Python time.struct_time对象转换为一个datetime对象</a></li></ul></li></ul></li></ul></div>
        </section>
    <section id="content">
        <p>更新到github了，地址：https://github.com/wklken/stackoverflow-py-top-qa </p>
<p>后续这里不更新了哈</p>
<hr/>
<p>进度40%，最近有点犯懒</p>
<p>刚刚注册，好东西</p>
<p>查看了下前面(vote前15页,挑了下,vote都是100+的样子,大概120个)的问题，<a href="http://stackoverflow.com/questions/tagged/python?page=1&amp;sort=votes&amp;pagesize=15">链接</a>, 大体梳理了下,本来想放一页搞定，奈何排版太乱，按类型分了下</p>
<p>第一页的前几个比较长，目测都有中文翻译版本，大家可以网上搜下</p>
<p>其他问题相对比较杂，有些简单，有些复杂，拉过来参考参考也不错</p>
<p>总结整理，复习印证(注意，合并了每个问题的多个答案，但是时间仓促，疏漏难免，感兴趣问题直接点链接看原文吧)</p>
<hr/>
<h2 id="_1">基本数据结构(列表，元组，字典等)</h2>
<h3 id="_2">判断一个列表为空得最佳实践</h3>
<p>问题 <a href="http://stackoverflow.com/questions/53513/python-what-is-the-best-way-to-check-if-a-list-is-empty">链接</a></p>
<p>答案:</p>
<div class="codehilite"><pre>if not a:
    print "List is empty"
#不要用len(a)来判断
</pre></div>
<h3 id="stringjoinlistlistjoinstring">为什么是string.join(list)而不是list.join(string)</h3>
<p>问题 <a href="http://stackoverflow.com/questions/493819/python-join-why-is-it-string-joinlist-instead-of-list-joinstring">链接</a></p>
<div class="codehilite"><pre>my_list = ["Hello", "world"]
print "-".join(my_list)
#为什么不是 my_list.join("-") 。。。。这个....
</pre></div>
<p>答案：</p>
<p>因为所有可迭代对象都可以被连接，但是连接者总是字符串</p>
<h3 id="_3">如何合并两个列表</h3>
<p>问题 <a href="http://stackoverflow.com/questions/1720421/merge-two-lists-in-python">链接</a></p>
<div class="codehilite"><pre>listone = [1,2,3]
listtwo = [4,5,6]
#outcome we expect: mergedlist == [1, 2, 3, 4, 5, 6]
</pre></div>
<p>1.不考虑顺序（原来问题不是很明确）</p>
<div class="codehilite"><pre>listone + listtwo
#linstone.extend(listtwo)也行，就是会修改listone
</pre></div>
<p>2.考虑顺序做些处理</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">listone</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">listtwo</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">itertools</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="n">listone</span><span class="p">,</span> <span class="n">listtwo</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">print</span> <span class="n">item</span>
<span class="o">...</span>
<span class="mi">1</span>
<span class="mi">2</span>
<span class="mi">3</span>
<span class="mi">4</span>
<span class="mi">5</span>
<span class="mi">6</span>
</pre></div>
<h3 id="_4">如何扁平一个二维数组</h3>
<p>问题 <a href="http://stackoverflow.com/questions/952914/making-a-flat-list-out-of-list-of-lists-in-python">链接</a></p>
<div class="codehilite"><pre>l = [[1,2,3],[4,5,6], [7], [8,9]]
变为[1, 2, 3, 4, 5, 6, 4, 5, 6, 7, 8, 9]
</pre></div>
<p>列表解析</p>
<div class="codehilite"><pre>[item for sublist in l for item in sublist]
</pre></div>
<p>itertools</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">itertools</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">list2d</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">merged</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">list2d</span><span class="p">))</span>

<span class="c1"># python &gt;= 2.6</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">itertools</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">list2d</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">merged</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">list2d</span><span class="p">))</span>
</pre></div>
<p>sum</p>
<div class="codehilite"><pre>sum(l, [])
</pre></div>
<h3 id="_5">如何获取一个列表的长度</h3>
<p>问题 <a href="http://stackoverflow.com/questions/518021/getting-the-length-of-an-array-in-python">链接</a></p>
<p>python中是不是只有这种方法可以获取长度？语法很奇怪</p>
<div class="codehilite"><pre>arr.__len__()
</pre></div>
<p>应该使用这种方式</p>
<div class="codehilite"><pre>mylist = [1,2,3,4,5]
len(mylist)
</pre></div>
<p>这样做法，不需要对每个容器都定义一个.length()方法，你可以使用len()检查所有实现了__len__()方法的对象</p>
<h3 id="python">Python中如何复制一个列表</h3>
<p>问题 <a href="http://stackoverflow.com/questions/2612802/how-to-clone-a-list-in-python">链接</a></p>
<p>可以用切片的方法</p>
<div class="codehilite"><pre>new_list = old_list[:]
</pre></div>
<p>可以使用list()函数</p>
<div class="codehilite"><pre>new_list = list(old_list)
</pre></div>
<p>可以使用copy.copy(),比list()稍慢，因为它首先去查询old_list的数据类型</p>
<div class="codehilite"><pre><span class="kn">import</span> <span class="nn">copy</span>
<span class="n">new_list</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">old_list</span><span class="p">)</span>
</pre></div>
<p>如果列表中包含对象，可以使用copy.deepcopy(), 所有方法中最慢，但有时候无法避免</p>
<div class="codehilite"><pre><span class="kn">import</span> <span class="nn">copy</span>
<span class="n">new_list</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">old_list</span><span class="p">)</span>
</pre></div>
<p>例子：</p>
<div class="codehilite"><pre><span class="kn">import</span> <span class="nn">copy</span>

<span class="k">class</span> <span class="nc">Foo</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">val</span> <span class="o">=</span> <span class="n">val</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">val</span><span class="p">)</span>

<span class="n">foo</span> <span class="o">=</span> <span class="n">Foo</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'foo'</span><span class="p">,</span> <span class="n">foo</span><span class="p">]</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="p">[:]</span>
<span class="n">c</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

<span class="c1"># edit orignal list and instance</span>
<span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'baz'</span><span class="p">)</span>
<span class="n">foo</span><span class="o">.</span><span class="n">val</span> <span class="o">=</span> <span class="mi">5</span>

<span class="k">print</span> <span class="s2">"original: </span><span class="si">%r</span><span class="se">\n</span><span class="s2"> slice: </span><span class="si">%r</span><span class="se">\n</span><span class="s2"> list(): </span><span class="si">%r</span><span class="se">\n</span><span class="s2"> copy: </span><span class="si">%r</span><span class="se">\n</span><span class="s2"> deepcopy: </span><span class="si">%r</span><span class="s2">"</span> \
       <span class="o">%</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
</pre></div>
<p>结果:</p>
<div class="codehilite"><pre>original: ['foo', 5, 'baz']
slice: ['foo', 5]
list(): ['foo', 5]
copy: ['foo', 5]
deepcopy: ['foo', 1]
</pre></div>
<p>效率简单比较</p>
<div class="codehilite"><pre>10.59 - copy.deepcopy(old_list)
10.16 - pure python Copy() method copying classes with deepcopy
1.488 - pure python Copy() method not copying classes (only dicts/lists/tuples)
0.325 - for item in old_list: new_list.append(item)
0.217 - [i for i in old_list] (a list comprehension)
0.186 - copy.copy(old_list)
0.075 - list(old_list)
0.053 - new_list = []; new_list.extend(old_list)
0.039 - old_list[:] (list slicing)
</pre></div>
<h3 id="appendextend">列表的append和extend的区别</h3>
<p>问题 <a href="http://stackoverflow.com/questions/252703/python-append-vs-extend">链接</a></p>
<div class="codehilite"><pre>&gt;&gt;&gt; x = [1, 2]
&gt;&gt;&gt; x.append(3)
&gt;&gt;&gt; x
[1, 2, 3]
&gt;&gt;&gt; x.append([4,5])
&gt;&gt;&gt; x
[1, 2, 3, [4, 5]]
&gt;&gt;&gt;
&gt;&gt;&gt; x = [1, 2, 3]
&gt;&gt;&gt; x.extend([4, 5])
&gt;&gt;&gt; x
[1, 2, 3, 4, 5]
</pre></div>
<h3 id="_6">如何随机地从列表中抽取变量</h3>
<p>问题 <a href="http://stackoverflow.com/questions/306400/how-do-i-randomly-select-an-item-from-a-list-using-python">链接</a></p>
<div class="codehilite"><pre><span class="n">foo</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'a'</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">,</span> <span class="s1">'c'</span><span class="p">,</span> <span class="s1">'d'</span><span class="p">,</span> <span class="s1">'e'</span><span class="p">]</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">choice</span>
<span class="k">print</span> <span class="n">choice</span><span class="p">(</span><span class="n">foo</span><span class="p">)</span>
</pre></div>
<h3 id="_7">如何利用下标从列表中删除一个元素</h3>
<p>问题 <a href="http://stackoverflow.com/questions/627435/how-to-remove-an-element-from-a-list-by-index-in-python">链接</a></p>
<p>1.del</p>
<div class="codehilite"><pre>In [9]: a = range(10)
In [10]: a
Out[10]: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
In [11]: del a[-1]
In [12]: a
Out[12]: [0, 1, 2, 3, 4, 5, 6, 7, 8]
</pre></div>
<p>2.pop</p>
<div class="codehilite"><pre>a = ['a', 'b', 'c', 'd']
a.pop(1)
# now a is ['a', 'c', 'd']

a = ['a', 'b', 'c', 'd']
a.pop()
# now a is ['a', 'b', 'c']
</pre></div>
<h3 id="_8">获取列表的最后一个元素</h3>
<p>问题 <a href="http://stackoverflow.com/questions/930397/how-to-get-the-last-element-of-a-list">链接</a></p>
<p>囧</p>
<div class="codehilite"><pre>result = l[-1]
result = l.pop()
</pre></div>
<h3 id="_9">序列的切片操作</h3>
<p>问题 <a href="http://stackoverflow.com/questions/509211/the-python-slice-notation">链接</a></p>
<p>It's pretty simple really:
很简单:</p>
<div class="codehilite"><pre>a[start:end] # start 到 end-1
a[start:]    # start 到 末尾
a[:end]      # 0 到 end-1
a[:]         # 整个列表的拷贝
</pre></div>
<p>还有一个step变量，控制步长,可在上面语法中使用</p>
<div class="codehilite"><pre>a[start:end:step] # start through not past end, by step
</pre></div>
<p>注意，左闭右开</p>
<p>其他特点，开始或结束下标可能是负数，表示从序列末尾开始计算而非从头开始计算,所以</p>
<div class="codehilite"><pre><span class="s s-Atom">a</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>    <span class="s s-Atom">#</span> <span class="s s-Atom">最后一个元素</span>
<span class="s s-Atom">a</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="s s-Atom">:</span><span class="p">]</span>   <span class="s s-Atom">#</span> <span class="s s-Atom">最后两个元素</span>
<span class="s s-Atom">a</span><span class="p">[:-</span><span class="mi">2</span><span class="p">]</span>   <span class="s s-Atom">#</span> <span class="s s-Atom">除了最后两个元素</span>
</pre></div>
<p>Python对程序员很友好，如果序列中存在的元素数量少于你要的，例如，你请求 a[:-2] 但是a只有一个元素，你会得到一个空列表，而不是一个错误.有时候你或许希望返回的是一个错误，所以你必须知道这点</p>
<h3 id="_10">如何将一个列表切分成若干个长度相同的子序列</h3>
<p>问题 <a href="http://stackoverflow.com/questions/312443/how-do-you-split-a-list-into-evenly-sized-chunks-in-python">链接</a></p>
<p>想要得到这样的效果</p>
<div class="codehilite"><pre>l = range(1, 1000)
print chunks(l, 10) -&gt; [ [ 1..10 ], [ 11..20 ], .., [ 991..999 ] ]
</pre></div>
<p>使用yield:</p>
<div class="codehilite"><pre>def chunks(l, n):
    """ Yield successive n-sized chunks from l.
    """
    for i in xrange(0, len(l), n):
        yield l[i:i+n]
list(chunks(range(10, 75), 10))
</pre></div>
<p>直接处理</p>
<div class="codehilite"><pre>def chunks(l, n):
    return [l[i:i+n] for i in range(0, len(l), n)]
</pre></div>
<h3 id="_11">使用列表解析创建一个字典</h3>
<p>问题 <a href="http://stackoverflow.com/questions/1747817/python-create-a-dictionary-with-list-comprehension">链接</a></p>
<p>python 2.6</p>
<div class="codehilite"><pre>d = dict((key, value) for (key, value) in sequence)
</pre></div>
<p>python 2.7+ or 3, 使用 <a href="http://www.python.org/dev/peps/pep-0274/">字典解析语法</a></p>
<div class="codehilite"><pre>d = {key: value for (key, value) in sequence}
</pre></div>
<h3 id="inhas_key">使用"in"还是"has_key()"</h3>
<p>问题 <a href="http://stackoverflow.com/questions/1323410/has-key-or-in">链接</a></p>
<div class="codehilite"><pre>d = {'a': 1, 'b': 2}
'a' in d
True
or:

d = {'a': 1, 'b': 2}
d.has_key('a')
True
</pre></div>
<p>哪种更好</p>
<p>in更pythonic, 另外 has_key()在Python3.x中已经被移除</p>
<h3 id="_12">字典默认值</h3>
<p>问题 <a href="http://stackoverflow.com/questions/1602934/check-if-a-given-key-already-exists-in-a-dictionary">链接</a></p>
<p>和问题有点偏</p>
<div class="codehilite"><pre><span class="c1">#获取时,如不存在，得到默认值</span>
<span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="c1">#设置时，若key不存在，设置默认值，已存在，返回已存在value</span>
<span class="n">d</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_element</span><span class="p">)</span>
<span class="c1">#初始即默认值</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span>
<span class="c1">#or d = defaultdict(int)</span>
</pre></div>
<h3 id="_13">如何给字典添加一个值</h3>
<p>问题 <a href="http://stackoverflow.com/questions/1024847/add-to-a-dictionary-in-python">链接</a></p>
<div class="codehilite"><pre>#### Making a dictionary ####
data = {}
# OR #
data = dict()

#### Initially adding values ####
data = {'a':1,'b':2,'c':3}
# OR #
data = dict(a=1, b=2, c=3)

#### Inserting/Updating value ####
data['a']=1  # updates if 'a' exists, else adds 'a'
# OR #
data.update({'a':1})
# OR #
data.update(dict(a=1))

#### Merging 2 dictionaries ####
data.update(data2)  # Where data2 is also a dict.
</pre></div>
<h3 id="object-">如何将字段转换成一个object，然后使用对象-属性的方式读取</h3>
<p>问题 <a href="http://stackoverflow.com/questions/1305532/convert-python-dict-to-object">链接</a></p>
<p>有dict</p>
<div class="codehilite"><pre>&gt;&gt;&gt; d = {'a': 1, 'b': {'c': 2}, 'd': ["hi", {'foo': "bar"}]}}
</pre></div>
<p>想用这种方式访问</p>
<div class="codehilite"><pre>&gt;&gt;&gt; x = dict2obj(d)
&gt;&gt;&gt; x.a
1
&gt;&gt;&gt; x.b.c
2
&gt;&gt;&gt; x.d[1].foo
bar
</pre></div>
<p>使用namedtuple</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">MyStruct</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">'MyStruct'</span><span class="p">,</span> <span class="s1">'a b d'</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s</span> <span class="o">=</span> <span class="n">MyStruct</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="p">{</span><span class="s1">'c'</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="n">d</span><span class="o">=</span><span class="p">[</span><span class="s1">'hi'</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s</span>
<span class="n">MyStruct</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="p">{</span><span class="s1">'c'</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="n">d</span><span class="o">=</span><span class="p">[</span><span class="s1">'hi'</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s</span><span class="o">.</span><span class="n">a</span>
<span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s</span><span class="o">.</span><span class="n">b</span>
<span class="p">{</span><span class="s1">'c'</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s</span><span class="o">.</span><span class="n">c</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s</span><span class="o">.</span><span class="n">d</span>
<span class="p">[</span><span class="s1">'hi'</span><span class="p">]</span>
</pre></div>
<p>使用类</p>
<div class="codehilite"><pre><span class="k">class</span> <span class="n">Struct:</span>
    <span class="n">def</span> <span class="n">__init__</span>(<span class="k">self</span>, **<span class="n">entries</span>):
        <span class="k">self</span>.<span class="n">__dict__</span>.<span class="n">update</span>(<span class="n">entries</span>)

&gt;&gt;&gt; <span class="n">args</span> = {<span class="s">'a'</span>: <span class="mi">1</span>, <span class="s">'b'</span>: <span class="mi">2</span>}
&gt;&gt;&gt; <span class="o">s</span> = <span class="n">Struct</span>(**<span class="n">args</span>)
&gt;&gt;&gt; <span class="o">s</span>
<span class="s">&lt;__main__.Struct instance at 0x01D6A738&gt;</span>
&gt;&gt;&gt; <span class="o">s</span>.<span class="n">a</span>
<span class="mi">1</span>
&gt;&gt;&gt; <span class="o">s</span>.<span class="n">b</span>
<span class="mi">2</span>
</pre></div>
<h2 id="_15">字符串，文件</h2>
<h3 id="_16">字符如何转为小写</h3>
<p>问题 <a href="http://stackoverflow.com/questions/6797984/how-to-convert-string-to-lowercase-in-python">链接</a></p>
<div class="codehilite"><pre>s = "Kilometer"
print(s.lower())
</pre></div>
<h3 id="_17">如何创建不存在的目录结构</h3>
<p>问题 <a href="http://stackoverflow.com/questions/273192/python-best-way-to-create-directory-if-it-doesnt-exist-for-file-write">链接</a></p>
<div class="codehilite"><pre>if not os.path.exists(directory):
    os.makedirs(directory)
</pre></div>
<p>需要注意的是，当目录在exists和makedirs两个函数调用之间被创建时，makedirs将抛出OSError</p>
<h3 id="_18">如何拷贝一个文件</h3>
<p>问题 <a href="http://stackoverflow.com/questions/123198/how-do-i-copy-a-file-in-python">链接</a></p>
<p><a href="http://docs.python.org/2/library/shutil.html">shutil</a>模块</p>
<div class="codehilite"><pre>copyfile(src, dst)
</pre></div>
<p>将src文件内容拷贝到dst，目标文件夹必须可写，否则将抛出IOError异常</p>
<p>如果目标文件已存在，将被覆盖</p>
<p>另外特殊文件，想字符文件，块设备文件，无法用这个方法进行拷贝</p>
<p>src/dst是字符串</p>
<h3 id="floatint">字符串转为float/int</h3>
<div class="codehilite"><pre>&gt;&gt;&gt; a = "545.2222"
&gt;&gt;&gt; float(a)
545.2222
&gt;&gt;&gt; int(a)
Traceback (most recent call last):
File "&lt;stdin&gt;", line 1, in &lt;module&gt;
ValueError: invalid literal for int() with base 10: '545.2222'
&gt;&gt;&gt; int(float(a))
545
&gt;&gt;&gt; int('544')
544
</pre></div>
<p>另一种，用 <a href="http://docs.python.org/2/library/ast.html#ast.literal_eval">ast</a>模块</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">ast</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="s2">"545.2222"</span><span class="p">)</span>
<span class="mf">545.2222</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="s2">"31"</span><span class="p">)</span>
<span class="mi">31</span>
</pre></div>
<h3 id="_19">如何反向输出一个字符串</h3>
<p>问题 <a href="http://stackoverflow.com/questions/931092/reverse-a-string-in-python">链接</a></p>
<p>做法</p>
<div class="codehilite"><pre><span class="s s-Atom">&gt;&gt;&gt;</span> <span class="s s-Atom">'hello world'</span><span class="p">[</span><span class="s s-Atom">::-</span><span class="mi">1</span><span class="p">]</span>
<span class="s s-Atom">'dlrow olleh'</span>
</pre></div>
<h3 id="_20">如何随机生成大写字母和数字组成的字符串</h3>
<div class="codehilite"><pre>6U1S75
4Z4UKK
U911K4
</pre></div>
<p>解决</p>
<div class="codehilite"><pre><span class="kn">import</span> <span class="nn">string</span><span class="o">,</span> <span class="nn">random</span>
<span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_uppercase</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">digits</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
</pre></div>
<h3 id="perl-chomp-line">逐行读文件去除换行符(perl chomp line)</h3>
<p>问题 <a href="http://stackoverflow.com/questions/275018/how-can-i-remove-chomp-a-newline-in-python">链接</a>
类似问题 <a href="http://stackoverflow.com/questions/761804/trimming-a-string-in-python">链接</a></p>
<p>读一个文件，如何获取每一行内容（不包括换行符）</p>
<p>比较pythonic的做法:</p>
<div class="codehilite"><pre>&gt;&gt;&gt; text = "line 1\nline 2\r\nline 3\nline 4"
&gt;&gt;&gt; text.splitlines()
['line 1', 'line 2', 'line 3', 'line 4']
</pre></div>
<p>用rstrip,(rstrip/lstrip/strip)</p>
<div class="codehilite"><pre><span class="c1">#去除了空白+换行</span>
<span class="o">&gt;&gt;&gt;</span> <span class="s1">'test string </span><span class="se">\n</span><span class="s1">'</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="s1">'test string'</span>
<span class="c1">#只去换行</span>
<span class="o">&gt;&gt;&gt;</span> <span class="s1">'test string </span><span class="se">\n</span><span class="s1">'</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
<span class="s1">'test string '</span>
<span class="c1">#更通用的做法，系统相关</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span>
<span class="s1">'linux2'</span>
<span class="o">&gt;&gt;&gt;</span> <span class="s2">"foo</span><span class="se">\r\n</span><span class="s2">"</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
<span class="s1">'foo</span><span class="se">\r</span><span class="s1">'</span>
</pre></div>
<h3 id="pythoncontains">python中字符串的contains</h3>
<p>问题 <a href="http://stackoverflow.com/questions/3437059/does-python-have-a-string-contains-method">链接</a></p>
<p>python中字符串判断contains</p>
<p>使用in关键字</p>
<div class="codehilite"><pre>if not "blah" in somestring: continue
if "blah" not in somestring: continue
</pre></div>
<p>使用字符串的find/index  (注意index查找失败抛异常)</p>
<div class="codehilite"><pre>s = "This be a string"
if s.find("is") == -1:
    print "No 'is' here!"
else:
    print "Found 'is' in the string."
</pre></div>
<h3 id="_21">如何判断一个字符串是数字</h3>
<p>问题 <a href="http://stackoverflow.com/questions/354038/how-do-i-check-if-a-string-is-a-number-in-python">链接</a></p>
<p>使用这种方法会不会十分丑陋和低效</p>
<div class="codehilite"><pre>def is_number(s):
    try:
        float(s)
        return True
    except ValueError:
        return False
</pre></div>
<p>使用这种方法并不丑陋和低效</p>
<p>使用isdigit(缺点，对非整数无能为力)</p>
<div class="codehilite"><pre>a = "03523"
a.isdigit()
</pre></div>
<h3 id="0">如何填充0到数字字符串中保证统一长度</h3>
<p>问题 <a href="http://stackoverflow.com/questions/339007/python-nicest-way-to-pad-zeroes-to-string">链接</a></p>
<p>对于字符串</p>
<div class="codehilite"><pre>&gt;&gt;&gt; n = '4'
&gt;&gt;&gt; print n.zfill(3)
&gt;&gt;&gt; '004'
</pre></div>
<p>对于数字,<a href="http://docs.python.org/2/library/string.html#formatexamples">相关文档</a></p>
<div class="codehilite"><pre>&gt;&gt;&gt; n = 4
&gt;&gt;&gt; print '%03d' % n
&gt;&gt;&gt; 004
&gt;&gt;&gt; print "{0:03d}".format(4)  # python &gt;= 2.6
&gt;&gt;&gt; 004
&gt;&gt;&gt; print("{0:03d}".format(4))  # python 3
&gt;&gt;&gt; 004
</pre></div>
<h2 id="_23">控制结构（条件、循环）</h2>
<h3 id="_24">如何在循环中获取下标</h3>
<p>问题 <a href="http://stackoverflow.com/questions/522563/accessing-the-index-in-python-for-loops">链接</a></p>
<p>使用enumerate</p>
<div class="codehilite"><pre>for idx, val in enumerate(ints):
    print idx, val
</pre></div>
<h3 id="_25">如何判断一个变量的类型</h3>
<p>问题 <a href="http://stackoverflow.com/questions/402504/how-to-determine-the-variable-type-in-python">链接</a></p>
<p>使用type</p>
<div class="codehilite"><pre>&gt;&gt;&gt; i = 123
&gt;&gt;&gt; type(i)
&lt;type 'int'&gt;
&gt;&gt;&gt; type(i) is int
True
&gt;&gt;&gt; i = 123456789L
&gt;&gt;&gt; type(i)
&lt;type 'long'&gt;
&gt;&gt;&gt; type(i) is long
True
&gt;&gt;&gt; i = 123.456
&gt;&gt;&gt; type(i)
&lt;type 'float'&gt;
&gt;&gt;&gt; type(i) is float
True
</pre></div>
<p>另外一个相同的问题  <a href="http://stackoverflow.com/questions/2225038/python-determine-the-type-of-an-object">链接</a></p>
<div class="codehilite"><pre>&gt;&gt;&gt; type( [] ) == list
True
&gt;&gt;&gt; type( {} ) == dict
True
&gt;&gt;&gt; type( "" ) == str
True
&gt;&gt;&gt; type( 0 ) == int
True

&gt;&gt;&gt; class Test1 ( object ):
    pass
&gt;&gt;&gt; class Test2 ( Test1 ):
    pass
&gt;&gt;&gt; a = Test1()
&gt;&gt;&gt; b = Test2()
&gt;&gt;&gt; type( a ) == Test1
True
&gt;&gt;&gt; type( b ) == Test2
True
&gt;&gt;&gt; type( b ) == Test1
False
&gt;&gt;&gt; isinstance( b, Test1 )
True
&gt;&gt;&gt; isinstance( b, Test2 )
True
&gt;&gt;&gt; isinstance( a, Test1 )
True
&gt;&gt;&gt; isinstance( a, Test2 )
False
&gt;&gt;&gt; isinstance( [], list )
True
&gt;&gt;&gt; isinstance( {}, dict )
True
</pre></div>
<h2 id="_27">类</h2>
<h3 id="_28">如何判断一个对象是否拥有某个属性</h3>
<p>问题 <a href="http://stackoverflow.com/questions/610883/how-to-know-if-an-object-has-an-attribute-in-python">链接</a></p>
<div class="codehilite"><pre>if hasattr(a, 'property'):
    a.property
</pre></div>
<p>两种风格</p>
<p>EAFP(easier to ask for forgiveness than permission)</p>
<p>LBYL(look before you leap)</p>
<p>相关内容
<a href="http://web.archive.org/web/20070929122422/http://mail.python.org/pipermail/python-list/2003-May/205182.html">EAFP vs LBYL (was Re: A little disappointed so far)</a>
<a href="http://python.net/~goodger/projects/pycon/2007/idiomatic/handout.html#eafp-vs-lbyl">EAFP vs. LBYL @Code Like a Pythonista: Idiomatic Python</a></p>
<div class="codehilite"><pre><span class="k">try</span><span class="o">:</span>
    <span class="n">doStuff</span><span class="o">(</span><span class="n">a</span><span class="o">.</span><span class="na">property</span><span class="o">)</span>
<span class="n">except</span> <span class="n">AttributeError</span><span class="o">:</span>
    <span class="n">otherStuff</span><span class="o">()</span>
<span class="n">or</span>

<span class="k">if</span> <span class="n">hasattr</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="s1">'property'</span><span class="o">):</span>
    <span class="n">doStuff</span><span class="o">(</span><span class="n">a</span><span class="o">.</span><span class="na">property</span><span class="o">)</span>
<span class="k">else</span><span class="o">:</span>
    <span class="n">otherStuff</span><span class="o">()</span>
</pre></div>
<h3 id="python_1">Python中的类变量(环境变量)</h3>
<p>问题 <a href="http://stackoverflow.com/questions/68645/static-class-variables-in-python">链接</a></p>
<p>在类中定义的变量，不在方法定义中，成为类变量或静态变量</p>
<div class="codehilite"><pre>&gt;&gt;&gt; class MyClass:
...     i = 3
...
&gt;&gt;&gt; MyClass.i
3
</pre></div>
<p>i是类级别的变量，但这里要和实例级别的变量i区分开</p>
<div class="codehilite"><pre>&gt;&gt;&gt; m = MyClass()
&gt;&gt;&gt; m.i = 4
&gt;&gt;&gt; MyClass.i, m.i
&gt;&gt;&gt; (3, 4)
</pre></div>
<p>这和C++/java完全不同，但和C#区别不大，C#不允许类实例获取静态变量</p>
<p>具体见 <a href="http://docs.python.org/2/tutorial/classes.html#SECTION0011320000000000000000">what the Python tutorial has to say on the subject of classes and class objects</a></p>
<p>另外，静态方法</p>
<div class="codehilite"><pre><span class="k">class</span> <span class="n">C:</span>
    <span class="nv">@staticmethod</span>
    <span class="n">def</span> <span class="n">f</span>(<span class="n">arg1</span>, <span class="n">arg2</span>, ...): ...
</pre></div>
<h3 id="static-method">如何定义静态方法(static method)</h3>
<p>问题 <a href="http://stackoverflow.com/questions/735975/static-methods-in-python">链接</a></p>
<p>使用 <a href="http://docs.python.org/2/library/functions.html#staticmethod">staticmethod</a>装饰器</p>
<div class="codehilite"><pre><span class="k">class</span> <span class="n">MyClass</span>(<span class="n">object</span>):
    <span class="nv">@staticmethod</span>
    <span class="n">def</span> <span class="n">the_static_method</span>(<span class="o">x</span>):
        <span class="nb">print</span> <span class="o">x</span>
<span class="n">MyClass</span>.<span class="n">the_static_method</span>(<span class="mi">2</span>) <span class="c c-Singleline"># outputs 2</span>
</pre></div>
<h3 id="staticmethodclassmethod">@staticmethod和@classmethod的区别</h3>
<p>问题 <a href="http://stackoverflow.com/questions/136097/what-is-the-difference-between-staticmethod-and-classmethod-in-python">链接</a></p>
<p>staticmethod，静态方法在调用时，对类及实例一无所知</p>
<p>仅仅是获取传递过来的参数，没有隐含的第一个参数，在Python里基本上用处不大，你完全可以用一个模块函数替换它</p>
<p>classmethod, 在调用时，将会获取到其所在的类，或者类实例，作为其第一个参数</p>
<p>当你想将函数作为一个类工厂时，这非常有用: 第一个参数是类，你可以实例化出对应实例对象，甚至子类对象。</p>
<p>可以观察下 dict.fromkey(),是一个类方法，当子类调用时，返回子类的实例</p>
<div class="codehilite"><pre>&gt;&gt;&gt; class DictSubclass(dict):
...     def __repr__(self):
...         return "DictSubclass"
...
&gt;&gt;&gt; dict.fromkeys("abc")
{'a': None, 'c': None, 'b': None}
&gt;&gt;&gt; DictSubclass.fromkeys("abc")
DictSubclass
&gt;&gt;&gt;
</pre></div>
<h3 id="_29">如何获取一个实例的类名</h3>
<p>问题 <a href="http://stackoverflow.com/questions/510972/getting-the-class-name-of-an-instance-in-python">链接</a></p>
<div class="codehilite"><pre>x.__class__.__name__
</pre></div>
<h2 id="_31">模块</h2>
<h3 id="_32">如何列出一个目录的所有文件</h3>
<p>问题 <a href="http://stackoverflow.com/questions/3207219/how-to-list-all-files-of-a-directory-in-python">链接</a></p>
<p>1.使用os.listdir(),得到目录下的所有文件和文件夹</p>
<div class="codehilite"><pre><span class="c1">#只需要文件</span>
<span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">listdir</span>
<span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">isfile</span><span class="p">,</span> <span class="n">join</span>
<span class="n">onlyfiles</span> <span class="o">=</span> <span class="p">[</span> <span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">listdir</span><span class="p">(</span><span class="n">mypath</span><span class="p">)</span> <span class="k">if</span> <span class="n">isfile</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">mypath</span><span class="p">,</span><span class="n">f</span><span class="p">))</span> <span class="p">]</span>
</pre></div>
<p>2.os.walk()</p>
<div class="codehilite"><pre><span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">walk</span>

<span class="n">f</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="p">(</span><span class="n">dirpath</span><span class="p">,</span> <span class="n">dirnames</span><span class="p">,</span> <span class="n">filenames</span><span class="p">)</span> <span class="ow">in</span> <span class="n">walk</span><span class="p">(</span><span class="n">mypath</span><span class="p">):</span>
    <span class="n">f</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">filenames</span><span class="p">)</span>
    <span class="k">break</span>
</pre></div>
<p>3.glob</p>
<div class="codehilite"><pre><span class="kn">import</span> <span class="nn">glob</span>
<span class="k">print</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">"/home/adam/*.txt"</span><span class="p">)</span>
</pre></div>
<p>重复问题 <a href="http://stackoverflow.com/questions/120656/directory-listing-in-python">链接</a></p>
<p>import os</p>
<div class="codehilite"><pre>for dirname, dirnames, filenames in os.walk('.'):
    # print path to all subdirectories first.
    for subdirname in dirnames:
        print os.path.join(dirname, subdirname)

    # print path to all filenames.
    for filename in filenames:
        print os.path.join(dirname, filename)
</pre></div>
<h3 id="jsonsimplejson">json和simplejson的区别</h3>
<p>问题 <a href="http://stackoverflow.com/questions/712791/json-and-simplejson-module-differences-in-python">链接</a></p>
<p>json就是simple，加入到标准库. json在2.6加入，simplejson在2.4+,2.6+,更有优势</p>
<p>另外，simplejson更新频率更高，如果你想使用最新版本，建议用simplejson</p>
<p>好的做法是</p>
<div class="codehilite"><pre><span class="k">try</span><span class="p">:</span> <span class="kn">import</span> <span class="nn">simplejson</span> <span class="kn">as</span> <span class="nn">json</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span> <span class="kn">import</span> <span class="nn">json</span>
</pre></div>
<p>另外,可以关注二者性能上的比较</p>
<h3 id="python_2">python中如何获取当前时间</h3>
<p>问题 <a href="http://stackoverflow.com/questions/415511/how-to-get-current-time-in-python">链接</a></p>
<p>时间日期</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">datetime</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<span class="n">datetime</span><span class="p">(</span><span class="mi">2009</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">78915</span><span class="p">)</span>
</pre></div>
<p>如果仅获取时间</p>
<div class="codehilite"><pre>&gt;&gt;&gt; datetime.datetime.time(datetime.datetime.now())
datetime.time(15, 8, 24, 78915))
#等价
&gt;&gt;&gt; datetime.datetime.now().time()
</pre></div>
<p>可以从文档中获取更多 <a href="http://docs.python.org/2/library/datetime.html">文档</a></p>
<p>如果想避免额外的datetime.</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
</pre></div>
<h2 id="_34">其他</h2>
<h3 id="stdin">如何从标准输入读取内容stdin</h3>
<p>问题 <a href="http://stackoverflow.com/questions/1450393/how-do-you-read-from-stdin-in-python">链接</a></p>
<p>使用<a href="http://docs.python.org/2/library/fileinput.html">fileinput</a></p>
<div class="codehilite"><pre><span class="kn">import</span> <span class="nn">fileinput</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fileinput</span><span class="o">.</span><span class="n">input</span><span class="p">():</span>
    <span class="k">pass</span>
</pre></div>
<h3 id="foo-is-none-foo-none">foo is None 和 foo == None的区别</h3>
<p>问题 <a href="http://stackoverflow.com/questions/26595/is-there-any-difference-between-foo-is-none-and-foo-none">链接</a></p>
<div class="codehilite"><pre>if foo is None: pass
if foo == None: pass
</pre></div>
<p>如果比较相同的对象实例，is总是返回True
而 == 最终取决于 "<strong>eq</strong>()"</p>
<div class="codehilite"><pre>&gt;&gt;&gt; class foo(object):
    def __eq__(self, other):
        return True

&gt;&gt;&gt; f = foo()
&gt;&gt;&gt; f == None
True
&gt;&gt;&gt; f is None
False

&gt;&gt;&gt; list1 = [1, 2, 3]
&gt;&gt;&gt; list2 = [1, 2, 3]]
&gt;&gt;&gt; list1==list2
True
&gt;&gt;&gt; list1 is list2
False
</pre></div>
<p>另外</p>
<div class="codehilite"><pre>(ob1 is ob2) 等价于 (id(ob1) == id(ob2))
</pre></div>
<h3 id="__init__py">__init__.py是做什么用的</h3>
<p>问题 <a href="http://stackoverflow.com/questions/448271/what-is-init-py-for">链接</a></p>
<p>这是包的一部分，<a href="http://docs.python.org/2/tutorial/modules.html#packages">具体文档</a></p>
<p>__init__.py让Python把目录当成包，</p>
<p>最简单的例子，__init__.py仅是一个空文件，但它可以一样执行包初始化代码或者设置__all__变量，后续说明</p>
<h3 id="python_3">如何获取安装的python模块列表</h3>
<p>问题 <a href="http://stackoverflow.com/questions/739993/get-a-list-of-installed-python-modules">链接</a></p>
<div class="codehilite"><pre>&gt;&gt;&gt; help('modules')
</pre></div>
<h2 id="_36">环境相关</h2>
<h3 id="setuppy">setup.py安装后如何卸载</h3>
<p>问题 <a href="http://stackoverflow.com/questions/1550226/python-setup-py-uninstall">链接</a></p>
<p>使用下面命令安装的包如何卸载</p>
<div class="codehilite"><pre>python setup.py install
</pre></div>
<p>手工删除的话</p>
<div class="codehilite"><pre>python setup.py install --record files.txt
cat files.txt | xargs rm -rf
</pre></div>
<h2 id="_38">异常</h2>
<h3 id="_39">如何一行内处理多个异常</h3>
<p>问题 <a href="http://stackoverflow.com/questions/6470428/catch-multiple-exceptions-in-one-line-except-block">链接</a></p>
<p>我知道可以这么做</p>
<div class="codehilite"><pre>try:
    # do something that may fail
except:
    # do this if ANYTHING goes wrong
</pre></div>
<p>也可以</p>
<div class="codehilite"><pre>try:
    # do something that may fail
except IDontLikeYourFaceException:
    # put on makeup or smile
except YouAreTooShortException:
    # stand on a ladder
</pre></div>
<p>如果想在一行里处理多个异常的话</p>
<div class="codehilite"><pre>try:
    # do something that may fail
except IDontLIkeYouException, YouAreBeingMeanException: #没生效
except Exception, e: #捕获了所有
    # say please
</pre></div>
<p>答案</p>
<div class="codehilite"><pre># as在python2.6,python2.7中仍然可以使用
except (IDontLIkeYouException, YouAreBeingMeanException) as e:
    pass
</pre></div>
<h3 id="flush-pythonprint">如何flush Python的print输出</h3>
<p>问题 <a href="http://stackoverflow.com/questions/230751/how-to-flush-output-of-python-print">链接</a>
重复问题 <a href="http://stackoverflow.com/questions/107705/python-output-buffering">链接</a></p>
<p>默认print输出到sys.stdout</p>
<div class="codehilite"><pre><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</pre></div>
<p>参考
<a href="http://docs.python.org/2/reference/simple_stmts.html#the-print-statement">http://docs.python.org/reference/simple_stmts.html#the-print-statement</a>
<a href="http://docs.python.org/2/library/sys.html">http://docs.python.org/library/sys.html</a>
<a href="http://docs.python.org/2/library/stdtypes.html#file-objects">http://docs.python.org/library/stdtypes.html#file-objects</a></p>
<h3 id="_40">如何获取一个函数的函数名字符串</h3>
<p>问题 <a href="http://stackoverflow.com/questions/251464/how-to-get-the-function-name-as-string-in-python">链接</a></p>
<div class="codehilite"><pre><span class="n">my_function</span><span class="o">.</span><span class="n">__name__</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">time</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">__name__</span>
<span class="s1">'time'</span>
</pre></div>
<h3 id="python3python2python3">应该在学习Python3之前学习Python2，还是直接学习Python3</h3>
<p>问题 <a href="http://stackoverflow.com/questions/170921/should-i-learn-python-2-before-3-or-start-directly-from-python-3">链接</a></p>
<p>你可以从python2开始，2和3主要的语法格式和风格相同</p>
<p>3要替代2不是短时间内能完成的，将会是一个很长的过程，所以学习Python2并没有什么坏处</p>
<p>我建议你关注下2和3的不同之处  <a href="http://stackoverflow.com/questions/170921/should-i-learn-python-2-before-3-or-start-directly-from-python-3">This slides gives you a quick introduction of the changes in Python 2 and 3</a></p>
<h3 id="pythonis">python中用==比较字符串，is有时候会返回错误判断</h3>
<p>问题 <a href="http://stackoverflow.com/questions/1504717/python-vs-is-comparing-strings-is-fails-sometimes-why">链接</a></p>
<p>is是身份测试，==是相等测试</p>
<div class="codehilite"><pre>&gt;&gt;&gt; a = 'pub'
&gt;&gt;&gt; b = ''.join(['p', 'u', 'b'])
&gt;&gt;&gt; a == b
True
&gt;&gt;&gt; a is b
False'
</pre></div>
<p>is 等价于 id(a) == id(b)</p>
<h3 id="_41">如何截取一个字符串获得子串</h3>
<p>问题 <a href="http://stackoverflow.com/questions/663171/is-there-a-way-to-substring-a-string-in-python">链接</a></p>
<div class="codehilite"><pre><span class="s s-Atom">&gt;&gt;&gt;</span> <span class="s s-Atom">x</span> <span class="o">=</span> <span class="s2">"Hello World!"</span>
<span class="s s-Atom">&gt;&gt;&gt;</span> <span class="s s-Atom">x</span><span class="p">[</span><span class="mi">2</span><span class="s s-Atom">:</span><span class="p">]</span>
<span class="s s-Atom">'llo World!'</span>
<span class="s s-Atom">&gt;&gt;&gt;</span> <span class="s s-Atom">x</span><span class="p">[</span><span class="s s-Atom">:</span><span class="mi">2</span><span class="p">]</span>
<span class="s s-Atom">'He'</span>
<span class="s s-Atom">&gt;&gt;&gt;</span> <span class="s s-Atom">x</span><span class="p">[:-</span><span class="mi">2</span><span class="p">]</span>
<span class="s s-Atom">'Hello Worl'</span>
<span class="s s-Atom">&gt;&gt;&gt;</span> <span class="s s-Atom">x</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="s s-Atom">:</span><span class="p">]</span>
<span class="s s-Atom">'d!'</span>
<span class="s s-Atom">&gt;&gt;&gt;</span> <span class="s s-Atom">x</span><span class="p">[</span><span class="mi">2</span><span class="p">:-</span><span class="mi">2</span><span class="p">]</span>
<span class="s s-Atom">'llo Worl'</span>
</pre></div>
<p>python将这类操作称为切片，可以作用于序列类型，不仅仅是字符串</p>
<h3 id="_42">用函数名字符串调用一个函数</h3>
<p>问题 <a href="http://stackoverflow.com/questions/3061/calling-a-function-from-a-string-with-the-functions-name-in-python">链接</a></p>
<p>假设模块foo有函数bar:</p>
<div class="codehilite"><pre><span class="kn">import</span> <span class="nn">foo</span>
<span class="n">methodToCall</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">foo</span><span class="p">,</span> <span class="s1">'bar'</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">methodToCall</span><span class="p">()</span>
</pre></div>
<p>或者一行搞定</p>
<div class="codehilite"><pre>result = getattr(foo, 'bar')()
</pre></div>
<h3 id="_43">如何获取文件扩展名</h3>
<p>问题 <a href="http://stackoverflow.com/questions/541390/extracting-extension-from-filename-in-python">链接</a></p>
<p>使用os.path.splitext方法：</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">os</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fileName</span><span class="p">,</span> <span class="n">fileExtension</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="s1">'/path/to/somefile.ext'</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fileName</span>
<span class="s1">'/path/to/somefile'</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fileExtension</span>
<span class="s1">'.ext'</span>
</pre></div>
<h3 id="list">如何获取list中包含某个元素所在的下标</h3>
<p>问题 <a href="http://stackoverflow.com/questions/176918/in-python-how-do-i-find-the-index-of-an-item-given-a-list-containing-it">链接</a></p>
<div class="codehilite"><pre>&gt;&gt;&gt; ["foo","bar","baz"].index('bar')
1
</pre></div>
<p>参照 <a href="http://docs.python.org/2/tutorial/datastructures.html#more-on-lists">文档</a></p>
<h3 id="tab">如何截掉空格（包括tab)</h3>
<p>问题 <a href="http://stackoverflow.com/questions/1185524/how-to-trim-whitespace-including-tabs">链接</a></p>
<p>空白在字符串左右两边</p>
<div class="codehilite"><pre>s = "  \t a string example\t  "
s = s.strip()
</pre></div>
<p>空白在字符串右边</p>
<div class="codehilite"><pre>s = s.rstrip()
</pre></div>
<p>左边</p>
<div class="codehilite"><pre>s = s.lstrip()
</pre></div>
<p>另外你可以指定要截掉的字符作为参数</p>
<div class="codehilite"><pre>s = s.strip(' \t\n\r')
</pre></div>
<h3 id="_44">如何将一个十六进制字符串转为整数</h3>
<p>问题 <a href="http://stackoverflow.com/questions/209513/convert-hex-string-to-int-in-python">链接</a></p>
<div class="codehilite"><pre>&gt;&gt;&gt; int("a", 16)
10
&gt;&gt;&gt; int("0xa",16)
10
</pre></div>
<h3 id="python_4">如何结束退出一个python脚本</h3>
<p>问题 <a href="http://stackoverflow.com/questions/73663/terminating-a-python-script">链接</a></p>
<div class="codehilite"><pre><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
</pre></div>
<p>详细 <a href="http://docs.python.org/2/library/sys.html">文档</a></p>
<h3 id="_45">如何往文件中追加文本</h3>
<p>问题 <a href="http://stackoverflow.com/questions/4706499/how-do-you-append-to-file-in-python">链接</a></p>
<div class="codehilite"><pre>with open("test.txt", "a") as myfile:
    myfile.write("appended text")
</pre></div>
<p>可以使用'a'或'a+b' mode打开文件，见 <a href="http://docs.python.org/2/library/functions.html#open">文档</a></p>
<h3 id="_46">如何使用不同分隔符切分字符串</h3>
<p>问题 <a href="http://stackoverflow.com/questions/1059559/python-strings-split-with-multiple-separators">链接</a></p>
<p>使用re.split  <a href="http://docs.python.org/2/library/re.html#re.split">文档</a></p>
<div class="codehilite"><pre>&gt;&gt;&gt; re.split('\W+', 'Words, words, words.')
['Words', 'words', 'words', '']
&gt;&gt;&gt; re.split('(\W+)', 'Words, words, words.')
['Words', ', ', 'words', ', ', 'words', '.', '']
&gt;&gt;&gt; re.split('\W+', 'Words, words, words.', 1)
['Words', 'words, words.'])
</pre></div>
<p>或者匹配获取正确的 re.findall</p>
<div class="codehilite"><pre><span class="kn">import</span> <span class="nn">re</span>
<span class="n">DATA</span> <span class="o">=</span> <span class="s2">"Hey, you - what are you doing here!?"</span>
<span class="k">print</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s2">r"[\w']+"</span><span class="p">,</span> <span class="n">DATA</span><span class="p">)</span>
<span class="c1"># Prints ['Hey', 'you', 'what', 'are', 'you', 'doing', 'here']</span>
</pre></div>
<h3 id="ascii">如何获取一个字符的ASCII码</h3>
<p>问题 <a href="http://stackoverflow.com/questions/227459/ascii-value-of-a-character-in-python">链接</a></p>
<div class="codehilite"><pre>&gt;&gt;&gt; ord('a')
97
&gt;&gt;&gt; chr(97)
'a'
&gt;&gt;&gt; chr(ord('a') + 3)
'd'
&gt;&gt;&gt;
</pre></div>
<p>另外对于unicode</p>
<div class="codehilite"><pre>&gt;&gt;&gt; unichr(97)
u'a'
&gt;&gt;&gt; unichr(1234)
u'\u04d2'
</pre></div>
<h3 id="dictdict">排序一个列表中的所有dict，根据dict内值</h3>
<p>问题 <a href="http://stackoverflow.com/questions/72899/in-python-how-do-i-sort-a-list-of-dictionaries-by-values-of-the-dictionary">链接</a></p>
<p>如何排序如下列表，根据name或age</p>
<div class="codehilite"><pre>[{'name':'Homer', 'age':39}, {'name':'Bart', 'age':10}]
</pre></div>
<p>简单的做法；</p>
<div class="codehilite"><pre>newlist = sorted(list_to_be_sorted, key=lambda k: k['name'])
</pre></div>
<p>高效的做法</p>
<div class="codehilite"><pre><span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span>
<span class="n">newlist</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">list_to_be_sorted</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="s1">'name'</span><span class="p">))</span>
</pre></div>
<h3 id="_47">读文件到列表中</h3>
<p>问题 <a href="http://stackoverflow.com/questions/3277503/python-read-file-line-by-line-into-array">链接</a></p>
<div class="codehilite"><pre>f = open('filename')
lines = f.readlines()
f.close()
等价
with open(fname) as f:
    content = f.readlines()
</pre></div>
<p><a href="http://docs.python.org/2/tutorial/inputoutput.html#reading-and-writing-files">文档</a></p>
<h3 id="http">如何用http下载一个文件</h3>
<p>问题 <a href="http://stackoverflow.com/questions/22676/how-do-i-download-a-file-over-http-using-python">链接</a></p>
<p>直接使用urllib</p>
<div class="codehilite"><pre><span class="kn">import</span> <span class="nn">urllib</span>
<span class="n">urllib</span><span class="o">.</span><span class="n">urlretrieve</span> <span class="p">(</span><span class="s2">"http://www.example.com/songs/mp3.mp3"</span><span class="p">,</span> <span class="s2">"mp3.mp3"</span><span class="p">)</span>
</pre></div>
<p>使用urllib2,并提供一个进度条</p>
<div class="codehilite"><pre><span class="kn">import</span> <span class="nn">urllib2</span>

<span class="n">url</span> <span class="o">=</span> <span class="s2">"http://download.thinkbroadband.com/10MB.zip"</span>

<span class="n">file_name</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'/'</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">'wb'</span><span class="p">)</span>
<span class="n">meta</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="n">file_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">meta</span><span class="o">.</span><span class="n">getheaders</span><span class="p">(</span><span class="s2">"Content-Length"</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="k">print</span> <span class="s2">"Downloading: </span><span class="si">%s</span><span class="s2"> Bytes: </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">file_size</span><span class="p">)</span>

<span class="n">file_size_dl</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">block_sz</span> <span class="o">=</span> <span class="mi">8192</span>
<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="nb">buffer</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">block_sz</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">buffer</span><span class="p">:</span>
        <span class="k">break</span>

    <span class="n">file_size_dl</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">buffer</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">buffer</span><span class="p">)</span>
    <span class="n">status</span> <span class="o">=</span> <span class="s2">r"</span><span class="si">%10d</span><span class="s2">  [</span><span class="si">%3.2f%%</span><span class="s2">]"</span> <span class="o">%</span> <span class="p">(</span><span class="n">file_size_dl</span><span class="p">,</span> <span class="n">file_size_dl</span> <span class="o">*</span> <span class="mf">100.</span> <span class="o">/</span> <span class="n">file_size</span><span class="p">)</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">status</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">status</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">print</span> <span class="n">status</span><span class="p">,</span>

<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
<p>使用第三方<a href="http://docs.python-requests.org/en/latest/index.html">requests</a>包</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">requests</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">url</span> <span class="o">=</span> <span class="s2">"http://download.thinkbroadband.com/10MB.zip"</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
<span class="mi">10485760</span>
</pre></div>
<h3 id="virtualenvpython">在virtualenv中如何使用不同的python版本</h3>
<p>问题 <a href="http://stackoverflow.com/questions/1534210/use-different-python-version-with-virtualenv">链接</a></p>
<p>在创建virtualenv实例时，使用-p选项</p>
<div class="codehilite"><pre>virtualenv -p /usr/bin/python2.6 &lt;path/to/new/virtualenv/&gt;
</pre></div>
<h3 id="python_5">python中如何将一行长代码切成多行</h3>
<p>问题 <a href="http://stackoverflow.com/questions/53162/how-can-i-do-a-line-break-line-continuation-in-python">链接</a></p>
<p>例如：</p>
<div class="codehilite"><pre>e = 'a' + 'b' + 'c' + 'd'
变成
e = 'a' + 'b' +
    'c' + 'd'
</pre></div>
<p>括号中，可以直接换行</p>
<div class="codehilite"><pre>a = dostuff(blahblah1, blahblah2, blahblah3, blahblah4, blahblah5,
            blahblah6, blahblah7)
</pre></div>
<p>非括号你可以这么做</p>
<div class="codehilite"><pre>a = '1' + '2' + '3' + \
    '4' + '5'
或者
a = ('1' + '2' + '3' +
    '4' + '5')
</pre></div>
<p>可以查看下代码风格： <a href="http://www.python.org/dev/peps/pep-0008/">style guide</a>
推荐是后一种，但某些个别情况下，加入括号会导致错误</p>
<h3 id="txt">如何找到一个目录下所有.txt文件</h3>
<p>问题 <a href="http://stackoverflow.com/questions/3964681/find-all-files-in-directory-with-extension-txt-with-python">链接</a></p>
<p>使用<a href="http://docs.python.org/2/library/glob.html">glob</a></p>
<div class="codehilite"><pre><span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s2">"/mydir"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">"*.txt"</span><span class="p">):</span>
    <span class="k">print</span> <span class="n">files</span>
</pre></div>
<p>使用os.listdir</p>
<div class="codehilite"><pre><span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s2">"/mydir"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s2">"."</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">files</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">".txt"</span><span class="p">):</span>
        <span class="k">print</span> <span class="n">files</span>
</pre></div>
<p>或者遍历目录</p>
<div class="codehilite"><pre><span class="kn">import</span> <span class="nn">os</span>
<span class="k">for</span> <span class="n">r</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="s2">"/mydir"</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">files</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">".txt"</span><span class="p">):</span>
            <span class="k">print</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">files</span><span class="p">)</span>
</pre></div>
<h3 id="import">如何使用绝对路径import一个模块</h3>
<p>问题 <a href="http://stackoverflow.com/questions/67631/how-to-import-a-module-given-the-full-path">链接</a></p>
<div class="codehilite"><pre><span class="kn">import</span> <span class="nn">imp</span>

<span class="n">foo</span> <span class="o">=</span> <span class="n">imp</span><span class="o">.</span><span class="n">load_source</span><span class="p">(</span><span class="s1">'module.name'</span><span class="p">,</span> <span class="s1">'/path/to/file.py'</span><span class="p">)</span>
<span class="n">foo</span><span class="o">.</span><span class="n">MyClass</span><span class="p">()</span>
</pre></div>
<h3 id="list_1">如何在遍历一个list时删除某些玄素</h3>
<p>问题 <a href="http://stackoverflow.com/questions/1207406/remove-items-from-a-list-while-iterating-in-python">链接</a></p>
<p>使用列表解析</p>
<div class="codehilite"><pre>somelist = [x for x in somelist if determine(x)]
</pre></div>
<p>上面那个操作将产生一个全新的somelist对象，而失去了对原有somelist对象的引用</p>
<div class="codehilite"><pre>#在原有对象上进行修改
somelist[:] = [x for x in somelist if determine(x)]
</pre></div>
<p>使用itertools</p>
<div class="codehilite"><pre><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">ifilterfalse</span>
<span class="n">somelist</span><span class="p">[:]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ifilterfalse</span><span class="p">(</span><span class="n">determine</span><span class="p">,</span> <span class="n">somelist</span><span class="p">))</span>
</pre></div>
<h3 id="_48">如何强制使用浮点数除法</h3>
<p>问题 <a href="http://stackoverflow.com/questions/1267869/how-can-i-force-division-to-be-floating-point-in-python">链接</a></p>
<p>如何强制使除法结果c是浮点数</p>
<div class="codehilite"><pre>c = a / b
</pre></div>
<p>可以使用__future__</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">4</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">6</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">c</span>
<span class="mf">0.66666666666666663</span>
</pre></div>
<p>或者转换,如果除数或被除数是浮点数，那么结果也是浮点数</p>
<div class="codehilite"><pre>c = a / float(b)
</pre></div>
<h3 id="_49">如何映射两个列表成为一个字典</h3>
<p>问题 <a href="http://stackoverflow.com/questions/209840/map-two-lists-into-a-dictionary-in-python">链接</a></p>
<p>两个列表</p>
<div class="codehilite"><pre>keys = ('name', 'age', 'food')
values = ('Monty', 42, 'spam')
</pre></div>
<p>如何得到</p>
<div class="codehilite"><pre>dict = {'name' : 'Monty', 'age' : 42, 'food' : 'spam'}
</pre></div>
<p>使用zip</p>
<div class="codehilite"><pre>&gt;&gt;&gt; keys = ['a', 'b', 'c']
&gt;&gt;&gt; values = [1, 2, 3]
&gt;&gt;&gt; dictionary = dict(zip(keys, values))
&gt;&gt;&gt; print dictionary
{'a': 1, 'b': 2, 'c': 3}
</pre></div>
<h3 id="_50">找到当前目录及文件所在目录</h3>
<p>问题 <a href="http://stackoverflow.com/questions/5137497/find-current-directory-and-files-directory">链接</a></p>
<p>查找当前目录使用os.getcwd()</p>
<p>查找某个文件的目录，使用, <a href="http://docs.python.org/2/library/os.path.html">os.path</a></p>
<div class="codehilite"><pre><span class="kn">import</span> <span class="nn">os.path</span>
<span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">__file__</span><span class="p">)</span>
</pre></div>
<h3 id="1-in-10-truefalse">为何1 in [1,0] == True执行结果是False</h3>
<p>问题 <a href="http://stackoverflow.com/questions/9284350/why-does-1-in-1-0-true-evaluate-to-false">链接</a></p>
<p>有如下</p>
<div class="codehilite"><pre>&gt;&gt;&gt; 1 in [1,0]             # This is expected
True
&gt;&gt;&gt; 1 in [1,0] == True     # This is strange
False
&gt;&gt;&gt; (1 in [1,0]) == True   # This is what I wanted it to be
True
&gt;&gt;&gt; 1 in ([1,0] == True)   # But it's not just a precedence issue!
                           # It did not raise an exception on the second example.

Traceback (most recent call last):
  File "&lt;pyshell#4&gt;", line 1, in &lt;module&gt;
      1 in ([1,0] == True)
      TypeError: argument of type 'bool' is not iterable
</pre></div>
<p>这里python使用了比较运算符链</p>
<div class="codehilite"><pre>1 in [1,0] == True
</pre></div>
<p>将被转为</p>
<div class="codehilite"><pre>(1 in [1, 0]) and ([1, 0] == True)
</pre></div>
<p>很显然是false的</p>
<p>同样的</p>
<div class="codehilite"><pre>a &lt; b &lt; c
</pre></div>
<p>会被转为</p>
<div class="codehilite"><pre>(a &lt; b) and (b &lt; c) # b不会被解析两次
</pre></div>
<p><a href="http://docs.python.org/2/reference/expressions.html#not-in">具体文档</a></p>
<h3 id="pythonswitch">Python中的switch替代语法</h3>
<p>问题 <a href="http://stackoverflow.com/questions/60208/replacements-for-switch-statement-in-python">链接</a></p>
<p>python中没有switch，有什么推荐的处理方法么</p>
<p>使用字典:</p>
<div class="codehilite"><pre>def f(x):
    return {
        'a': 1,
        'b': 2,
    }.get(x, 9)
</pre></div>
<p>Python Cookbook中的几种方式</p>
<p><a href="http://code.activestate.com/recipes/410692/">Readable switch construction without lambdas or dictionaries</a></p>
<p><a href="http://code.activestate.com/recipes/410695/">Exception-based Switch-Case</a></p>
<p><a href="http://code.activestate.com/recipes/181064/">Using a Dictionary in place of a 'switch' statement</a></p>
<h3 id="datetime">如何将字符串转换为datetime</h3>
<p>问题 <a href="http://stackoverflow.com/questions/466345/converting-string-into-datetime">链接</a></p>
<p>可以查看下time模块的<a href="http://docs.python.org/2/library/time.html#time.strptime">strptime</a>方法，反向操作是<a href="http://docs.python.org/2/library/time.html#time.strftime">strftime</a></p>
<div class="codehilite"><pre><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="n">date_object</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="s1">'Jun 1 2005  1:33PM'</span><span class="p">,</span> <span class="s1">'%b </span><span class="si">%d</span><span class="s1"> %Y %I:%M%p'</span><span class="p">)</span>
</pre></div>
<p><a href="http://docs.python.org/2/library/datetime.html#strftime-and-strptime-behavior">扩展文档</a></p>
<h3 id="python_6">Python中有没有简单优雅的方式定义单例类</h3>
<p>问题 <a href="http://stackoverflow.com/questions/31875/is-there-a-simple-elegant-way-to-define-singletons-in-python">链接</a></p>
<p>我不认为有必要，一个拥有函数的模块（不是类）可以作为很好的单例使用，它的所有变量被绑定到这个模块，无论如何都不能被重复实例化</p>
<p>如果你确实想用一个类来实现，在python中不能创建私有类或私有构造函数,所以你不能隔离多个实例而仅仅通过自己的API来访问属性</p>
<p>我还是认为将函数放入模块，并将其作为一个单例来使用是最好的办法</p>
<h3 id="_51">将一个字符串转为一个字典</h3>
<p>问题 <a href="http://stackoverflow.com/questions/988228/converting-a-string-to-dictionary">链接</a></p>
<p>如何将字符串转成字典，不适用eval</p>
<div class="codehilite"><pre>s = "{'muffin' : 'lolz', 'foo' : 'kitty'}"
</pre></div>
<p>从python2.6开始，你可以使用内建模块 ast.literal_eval</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">ast</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="s2">"{'muffin' : 'lolz', 'foo' : 'kitty'}"</span><span class="p">)</span>
<span class="p">{</span><span class="s1">'muffin'</span><span class="p">:</span> <span class="s1">'lolz'</span><span class="p">,</span> <span class="s1">'foo'</span><span class="p">:</span> <span class="s1">'kitty'</span><span class="p">}</span>
</pre></div>
<p>这个做法比直接eval更安全
帮助文档</p>
<div class="codehilite"><pre>&gt;&gt;&gt; help(ast.literal_eval)
Help on function literal_eval in module ast:

literal_eval(node_or_string)
    Safely evaluate an expression node or a string containing a Python
    expression.  The string or node provided may only consist of the following
    Python literal structures: strings, numbers, tuples, lists, dicts, booleans,
    and None.
</pre></div>
<p>举例</p>
<div class="codehilite"><pre>&gt;&gt;&gt; eval("shutil.rmtree('mongo')")
Traceback (most recent call last):
File "&lt;stdin&gt;", line 1, in &lt;module&gt;
File "&lt;string&gt;", line 1, in &lt;module&gt;
File "/opt/Python-2.6.1/lib/python2.6/shutil.py", line 208, in rmtree
    onerror(os.listdir, path, sys.exc_info())
File "/opt/Python-2.6.1/lib/python2.6/shutil.py", line 206, in rmtree
    names = os.listdir(path)
OSError: [Errno 2] No such file or directory: 'mongo'
&gt;&gt;&gt; ast.literal_eval("shutil.rmtree('mongo')")
Traceback (most recent call last):
File "&lt;stdin&gt;", line 1, in &lt;module&gt;
File "/opt/Python-2.6.1/lib/python2.6/ast.py", line 68, in literal_eval
    return _convert(node_or_string)
File "/opt/Python-2.6.1/lib/python2.6/ast.py", line 67, in _convert
    raise ValueError('malformed string')
ValueError: malformed string
</pre></div>
<h3 id="pythonlisttuple">Python如何检查一个对象是list或者tuple，但是不是一个字符串</h3>
<p>问题 <a href="http://stackoverflow.com/questions/1835018/python-check-if-an-object-is-a-list-or-tuple-but-not-string">链接</a></p>
<p>原来的做法是</p>
<div class="codehilite"><pre>assert isinstance(lst, (list, tuple))
</pre></div>
<p>有没有更好的做法</p>
<p>我认为下面的方式是你需要的</p>
<div class="codehilite"><pre>assert not isinstance(lst, basestring)
</pre></div>
<p>原来的方式，你可能会漏过很多像列表，但并非list/tuple的</p>
<h3 id="if-x-is-not-none-if-not-x-is-none">使用 'if x is not None' 还是'if not x is None'</h3>
<p>问题 <a href="http://stackoverflow.com/questions/2710940/python-if-x-is-not-none-or-if-not-x-is-none">链接</a></p>
<p>我总想着使用 'if x is not None' 会更加简明</p>
<p>但是google的Python风格指南使用的却是 'if x is not None'</p>
<p>性能上没有什么区别，他们编译成相同的字节码</p>
<div class="codehilite"><pre><span class="n">Python</span> <span class="mf">2.6</span><span class="o">.</span><span class="mi">2</span> <span class="p">(</span><span class="n">r262</span><span class="p">:</span><span class="mi">71600</span><span class="p">,</span> <span class="n">Apr</span> <span class="mi">15</span> <span class="mi">2009</span><span class="p">,</span> <span class="mo">07</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">39</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">dis</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>    <span class="k">return</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dis</span><span class="o">.</span><span class="n">dis</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="mi">2</span>           <span class="mi">0</span> <span class="n">LOAD_FAST</span>                <span class="mi">0</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="mi">3</span> <span class="n">LOAD_CONST</span>               <span class="mi">0</span> <span class="p">(</span><span class="bp">None</span><span class="p">)</span>
            <span class="mi">6</span> <span class="n">COMPARE_OP</span>               <span class="mi">9</span> <span class="p">(</span><span class="ow">is</span> <span class="ow">not</span><span class="p">)</span>
            <span class="mi">9</span> <span class="n">RETURN_VALUE</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="o">...</span>   <span class="k">return</span> <span class="ow">not</span> <span class="n">x</span> <span class="ow">is</span> <span class="bp">None</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dis</span><span class="o">.</span><span class="n">dis</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="mi">2</span>           <span class="mi">0</span> <span class="n">LOAD_FAST</span>                <span class="mi">0</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="mi">3</span> <span class="n">LOAD_CONST</span>               <span class="mi">0</span> <span class="p">(</span><span class="bp">None</span><span class="p">)</span>
            <span class="mi">6</span> <span class="n">COMPARE_OP</span>               <span class="mi">9</span> <span class="p">(</span><span class="ow">is</span> <span class="ow">not</span><span class="p">)</span>
            <span class="mi">9</span> <span class="n">RETURN_VALUE</span>
</pre></div>
<p>在风格上，我尽量避免 'not x is y' 这种形式，虽然编译器会认为和 'not (x is y)'一样，但是读代码的人或许会误解为 '(not x) is y'</p>
<p>如果写作 'x is not y' 就不会有歧义</p>
<p>最佳实践</p>
<div class="codehilite"><pre>if x is not None:
    # Do something about x
</pre></div>
<h3 id="_52">如何获取一个文件的创建和修改时间</h3>
<p>问题 <a href="http://stackoverflow.com/questions/237079/how-to-get-file-creation-modification-date-times-in-python">链接</a></p>
<p>跨平台的获取文件创建及修改时间的方法</p>
<p>你有很多选择</p>
<p>使用<a href="http://docs.python.org/release/2.5.2/lib/module-os.path.html#l2h-2177">os.path.getmtime</a>或者<a href="http://docs.python.org/release/2.5.2/lib/module-os.path.html#l2h-2178">os.path.getctime</a></p>
<div class="codehilite"><pre><span class="kn">import</span> <span class="nn">os.path</span><span class="o">,</span> <span class="nn">time</span>
<span class="k">print</span> <span class="s2">"last modified: </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="n">time</span><span class="o">.</span><span class="n">ctime</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getmtime</span><span class="p">(</span><span class="nb">file</span><span class="p">))</span>
<span class="k">print</span> <span class="s2">"created: </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="n">time</span><span class="o">.</span><span class="n">ctime</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getctime</span><span class="p">(</span><span class="nb">file</span><span class="p">))</span>
</pre></div>
<p>或者<a href="http://www.python.org/doc/2.5.2/lib/module-stat.html">os.stat</a></p>
<div class="codehilite"><pre><span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">time</span>
<span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">ino</span><span class="p">,</span> <span class="n">dev</span><span class="p">,</span> <span class="n">nlink</span><span class="p">,</span> <span class="n">uid</span><span class="p">,</span> <span class="n">gid</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">atime</span><span class="p">,</span> <span class="n">mtime</span><span class="p">,</span> <span class="n">ctime</span><span class="p">)</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">stat</span><span class="p">(</span><span class="nb">file</span><span class="p">)</span>
<span class="k">print</span> <span class="s2">"last modified: </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="n">time</span><span class="o">.</span><span class="n">ctime</span><span class="p">(</span><span class="n">mtime</span><span class="p">)</span>
</pre></div>
<p>注意，ctime()并非指*nix系统中文件创建时间，而是这个节点数据的最后修改时间</p>
<h3 id="virtualenv">如何离开virtualenv</h3>
<p>问题 <a href="http://stackoverflow.com/questions/990754/how-to-leave-a-python-virtualenv">链接</a></p>
<p>使用virtualenv时</p>
<div class="codehilite"><pre>me@mymachine:~$ workon env1
(env1)me@mymachine:~$ workon env2
(env2)me@mymachine:~$ workon env1
(env1)me@mymachine:~$
</pre></div>
<p>如何退出某个环境</p>
<div class="codehilite"><pre>$ deactivate
</pre></div>
<h3 id="_53">如何认为地抛出一个异常</h3>
<p>问题 <a href="http://stackoverflow.com/questions/2052390/how-do-i-manually-throw-raise-an-exception-in-python">链接</a></p>
<p>pythonic</p>
<div class="codehilite"><pre>raise Exception("I know python!")
</pre></div>
<p>更多可参考 <a href="http://docs.python.org/2/reference/simple_stmts.html#the-raise-statement">文档</a></p>
<h3 id="python_7">在Python中如何展示二进制字面值</h3>
<p>问题 <a href="http://stackoverflow.com/questions/1476/how-do-you-express-binary-literals-in-python">链接</a></p>
<p>十六进制可以</p>
<div class="codehilite"><pre>&gt;&gt;&gt; 0x12AF
4783
&gt;&gt;&gt; 0x100
256
</pre></div>
<p>八进制可以</p>
<div class="codehilite"><pre>&gt;&gt;&gt; 01267
695
&gt;&gt;&gt; 0100
64
</pre></div>
<p>二进制如何表示？</p>
<p>Python 2.5 及更早版本: 可以表示为 int('01010101111',2)  但没有字面量</p>
<p>Python 2.6 beta: 可以使用0b1100111 or 0B1100111 表示</p>
<p>Python 2.6 beta: 也可以使用 0o27 or 0O27 (第二字字符是字母 O)</p>
<p>Python 3.0 beta: 同2.6，但不支持027这种语法</p>
<h3 id="python_8">Python中检查类型的权威方法</h3>
<p>问题 <a href="http://stackoverflow.com/questions/152580/whats-the-canonical-way-to-check-for-type-in-python">链接</a></p>
<p>检查一个对象是否是给定类型或者对象是否继承于给定类型？</p>
<p>比如给定一个对象o,如何判断是不是一个str</p>
<p>检查是否是str</p>
<div class="codehilite"><pre>type(o) is str
</pre></div>
<p>检查是否是str或者str的子类</p>
<div class="codehilite"><pre>isinstance(o, str)
</pre></div>
<p>下面的方法在某些情况下有用</p>
<div class="codehilite"><pre>issubclass(type(o), str)
type(o) in ([str] + str.__subclasses__())
</pre></div>
<p>注意，你或许想要的是</p>
<div class="codehilite"><pre>isinstance(o, basestring)
</pre></div>
<p>因为unicode字符串可以满足判定(unicode 不是str的子类，但是str和unicode都是basestring的子类)</p>
<p>可选的，isinstance可以接收多个类型参数，只要满足其中一个即True</p>
<div class="codehilite"><pre>isinstance(o, (str, unicode))
</pre></div>
<h3 id="pythonsite-packages">如何获取Python的site-packages目录位置</h3>
<p>问题 <a href="http://stackoverflow.com/questions/122327/how-do-i-find-the-location-of-my-python-site-packages-directory">链接</a></p>
<p>参考 <a href="http://docs.djangoproject.com/en/dev/topics/install/#remove-any-old-versions-of-django">How to Install Django" documentation</a></p>
<p>可以在shell中执行</p>
<div class="codehilite"><pre><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s2">"from distutils.sysconfig import get_python_lib; print(get_python_lib())"</span>
</pre></div>
<p>更好的可读性</p>
<div class="codehilite"><pre><span class="kn">from</span> <span class="nn">distutils.sysconfig</span> <span class="kn">import</span> <span class="n">get_python_lib</span>
<span class="k">print</span><span class="p">(</span><span class="n">get_python_lib</span><span class="p">())</span>
</pre></div>
<h3 id="python_9">Python中*<em>和</em>的作用</h3>
<p>问题  <a href="http://stackoverflow.com/questions/36901/what-does-double-star-and-star-do-for-python-parameters">链接</a></p>
<p><em>args和</em>*kwargs允许函数拥有任意数量的参数，具体可以查看 <a href="http://docs.python.org/dev/tutorial/controlflow.html#more-on-defining-functions">more on defining functions</a></p>
<p>*args将函数所有参数转为序列</p>
<div class="codehilite"><pre>In [1]: def foo(*args):
...:     for a in args:
...:         print a
...:
...:

In [2]: foo(1)
1


In [4]: foo(1,2,3)
1
2
3
</pre></div>
<p>**kwargs 将函数所有关键字参数转为一个字典</p>
<div class="codehilite"><pre>In [5]: def bar(**kwargs):
...:     for a in kwargs:
...:         print a, kwargs[a]
...:
...:

In [6]: bar(name="one", age=27)
age 27
name one
</pre></div>
<p>两种用法可以组合使用</p>
<div class="codehilite"><pre>def foo(kind, *args, **kwargs):
    pass
</pre></div>
<p>*l的另一个用法是用于函数调用时的参数列表解包(unpack)</p>
<div class="codehilite"><pre>In [9]: def foo(bar, lee):
...:     print bar, lee
...:
...:

In [10]: l = [1,2]

In [11]: foo(*l)
1 2
</pre></div>
<p>在Python3.0中，可以将*l放在等号左边用于赋值  <a href="http://www.python.org/dev/peps/pep-3132/">Extended Iterable Unpacking</a></p>
<div class="codehilite"><pre>first, *rest = [1,2,3,4]
first, *l, last = [1,2,3,4]
</pre></div>
<h3 id="vs-format">字符串格式化 % vs format</h3>
<p>问题 <a href="http://stackoverflow.com/questions/5082452/python-string-formatting-vs-format">链接</a></p>
<p>Python2.6中引入string.format()方法，语法和原先%操作符的字符串格式化差异较大</p>
<p>在什么情况下使用哪种更好?</p>
<p>以下的输出是一致的，有什么区别</p>
<div class="codehilite"><pre><span class="ch">#!/usr/bin/python</span>
<span class="n">sub1</span> <span class="o">=</span> <span class="s2">"python string!"</span>
<span class="n">sub2</span> <span class="o">=</span> <span class="s2">"an arg"</span>

<span class="n">a</span> <span class="o">=</span> <span class="s2">"i am a </span><span class="si">%s</span><span class="s2">"</span><span class="o">%</span><span class="n">sub1</span>
<span class="n">b</span> <span class="o">=</span> <span class="s2">"i am a {0}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sub1</span><span class="p">)</span>

<span class="n">c</span> <span class="o">=</span> <span class="s2">"with </span><span class="si">%(kwarg)s</span><span class="s2">!"</span><span class="o">%</span><span class="p">{</span><span class="s1">'kwarg'</span><span class="p">:</span><span class="n">sub2</span><span class="p">}</span>
<span class="n">d</span> <span class="o">=</span> <span class="s2">"with {kwarg}!"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kwarg</span><span class="o">=</span><span class="n">sub2</span><span class="p">)</span>

<span class="k">print</span> <span class="n">a</span>
<span class="k">print</span> <span class="n">b</span>
<span class="k">print</span> <span class="n">c</span>
<span class="k">print</span> <span class="n">d</span>
</pre></div>
<p>.format 看起来更加强大，可以用在很多情况.</p>
<p>例如你可以在格式化时重用传入的参数,而你用%时无法做到这点</p>
<p>另一个比较讨厌的是，%只处理 一个变量或一个元组, 你或许会认为下面的语法是正确的</p>
<div class="codehilite"><pre>"hi there %s" % name
</pre></div>
<p>但当name恰好是(1,2,3)时，会抛出TypeError异常.为了保证总是正确的，你必须这么写</p>
<div class="codehilite"><pre>"hi there %s" % (name,)   # supply the single argument as a single-item tuple
</pre></div>
<p>这么写很丑陋， .format没有这些问题</p>
<p>什么时候不考虑使用.format</p>
<div class="codehilite"><pre>你对.format知之甚少
使用Python2.5
</pre></div>
<h3 id="python_10">Python中什么项目结构更好</h3>
<p>问题 <a href="http://stackoverflow.com/questions/193161/what-is-the-best-project-structure-for-a-python-application">链接</a></p>
<p>假设你要开发一个较大的客户端程序(非web端),如何组织项目目录和递归？</p>
<p>不要太在意这个.按你高兴的方式组织就行.Python项目很简单，所以没有那么多愚蠢的规则</p>
<div class="codehilite"><pre>/scripts or /bin  命令行脚本
/tests 测试
/lib C-语言包
/doc 文档
/apidoc api文档
</pre></div>
<p>并且顶层目录包含README和Config</p>
<p>难以抉择的是，是否使用/src树. /src,/lib,/bin在Python中没有明显的区别，和Java/c不同</p>
<p>因为顶层/src文件夹显得没有什么实际意义，你的顶层目录可以是程序顶层架构的目录</p>
<div class="codehilite"><pre>/foo
/bar
/baz
</pre></div>
<p>我建议将这些文件放入到"模块名"的目录中，这样，如果你在写一个应用叫做quux, /quux目录将包含所有这些东西</p>
<p>你可以在PYTHONPATH中加入 /path/to/quux/foo,这样你可以QUUX.foo中重用模块</p>
<p>另一个回答</p>
<div class="codehilite"><pre>Project/
|-- bin/
|   |-- project
|
|-- project/
|   |-- test/
|   |   |-- __init__.py
|   |   |-- test_main.py
|   |
|   |-- __init__.py
|   |-- main.py
|
|-- setup.py
|-- README
</pre></div>
<h3 id="argparse">argparse可选位置参数</h3>
<p>问题 <a href="http://stackoverflow.com/questions/4480075/argparse-optional-positional-arguments">链接</a></p>
<p>脚本运行 usage: installer.py dir [-h] [-v]</p>
<p>dir是一个位置参数，定义如下</p>
<div class="codehilite"><pre>parser.add_argument('dir', default=os.getcwd())
</pre></div>
<p>我想让dir变为可选，如果未设置，使用os.getcwd()</p>
<p>不幸的是，当我不指定dir时，得到错误 "Error: Too few arguments"</p>
<p>尝试使用 nargs='?'</p>
<div class="codehilite"><pre>parser.add_argument('dir', nargs='?', default=os.getcwd())
</pre></div>
<p>例子</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">argparse</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">'-v'</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">'store_true'</span><span class="p">)</span>
<span class="n">_StoreTrueAction</span><span class="p">(</span><span class="n">option_strings</span><span class="o">=</span><span class="p">[</span><span class="s1">'-v'</span><span class="p">],</span> <span class="n">dest</span><span class="o">=</span><span class="s1">'v'</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">const</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">'dir'</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="s1">'?'</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
<span class="n">_StoreAction</span><span class="p">(</span><span class="n">option_strings</span><span class="o">=</span><span class="p">[],</span> <span class="n">dest</span><span class="o">=</span><span class="s1">'dir'</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="s1">'?'</span><span class="p">,</span> <span class="n">const</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">'/home/vinay'</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="s1">'somedir -v'</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
<span class="n">Namespace</span><span class="p">(</span><span class="nb">dir</span><span class="o">=</span><span class="s1">'somedir'</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="s1">'-v'</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
<span class="n">Namespace</span><span class="p">(</span><span class="nb">dir</span><span class="o">=</span><span class="s1">'/home/vinay'</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="s1">''</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
<span class="n">Namespace</span><span class="p">(</span><span class="nb">dir</span><span class="o">=</span><span class="s1">'/home/vinay'</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">([</span><span class="s1">'somedir'</span><span class="p">])</span>
<span class="n">Namespace</span><span class="p">(</span><span class="nb">dir</span><span class="o">=</span><span class="s1">'somedir'</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="s1">'somedir -h -v'</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
<span class="n">usage</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">v</span><span class="p">]</span> <span class="p">[</span><span class="nb">dir</span><span class="p">]</span>

<span class="n">positional</span> <span class="n">arguments</span><span class="p">:</span>
<span class="nb">dir</span>

<span class="n">optional</span> <span class="n">arguments</span><span class="p">:</span>
<span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>  <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span> <span class="ow">and</span> <span class="nb">exit</span>
<span class="o">-</span><span class="n">v</span>
</pre></div>
<h3 id="python-new-__init__">Python中 <strong>new</strong> 和 __init__的用法</h3>
<p>问题 <a href="http://stackoverflow.com/questions/674304/pythons-use-of-new-and-init">链接</a></p>
<p>我很疑惑，为何__init__总是在__new__之后调用</p>
<p>如下</p>
<div class="codehilite"><pre><span class="k">class</span> <span class="n">A</span>(<span class="n">object</span>):
    <span class="n">_dict</span> = <span class="n">dict</span>()

    <span class="n">def</span> <span class="n">__new__</span>(<span class="n">cls</span>):
        <span class="k">if</span> <span class="s">'key'</span> <span class="n">in</span> <span class="n">A</span>.<span class="n">_dict:</span>
            <span class="nb">print</span> <span class="s">"EXISTS"</span>
            <span class="k">return</span> <span class="n">A</span>.<span class="n">_dict</span>[<span class="s">'key'</span>]
        <span class="n">else:</span>
            <span class="nb">print</span> <span class="s">"NEW"</span>
            <span class="k">return</span> <span class="n">super</span>(<span class="n">A</span>, <span class="n">cls</span>).<span class="n">__new__</span>(<span class="n">cls</span>)

    <span class="n">def</span> <span class="n">__init__</span>(<span class="k">self</span>):
        <span class="nb">print</span> <span class="s">"INIT"</span>
        <span class="n">A</span>.<span class="n">_dict</span>[<span class="s">'key'</span>] = <span class="k">self</span>
        <span class="nb">print</span> <span class="s">""</span>

<span class="n">a1</span> = <span class="n">A</span>()
<span class="n">a2</span> = <span class="n">A</span>()
<span class="n">a3</span> = <span class="n">A</span>()
</pre></div>
<p>输出</p>
<div class="codehilite"><pre>NEW
INIT

EXISTS
INIT

EXISTS
INIT
</pre></div>
<p>有木有人可以解释一下</p>
<p>来自 <a href="http://mail.python.org/pipermail/tutor/2008-April/061426.html">链接</a></p>
<p>使用__new__,当你需要控制一个实例的生成</p>
<p>使用__init__,当你需要控制一个实例的初始化</p>
<p>__new__是实例创建的第一步.最先被调用，并且负责返回类的一个新实例.</p>
<p>相反的,__init__不返回任何东西，只是负责在实例创建后进行初始化</p>
<p>通常情况下，你不必重写__new__除非你写一个子类继承不可变类型，例如str,int,unicode或tuple</p>
<p>你必须了解到，你尝试去做的用<a href="http://en.wikipedia.org/wiki/Factory_object">Factory</a>可以很好地解决，并且是最好的解决方式.使用__new__不是一个简洁的处理方式,一个<a href="http://code.activestate.com/recipes/86900/">factory例子</a></p>
<h3 id="python-self">Python 'self' 解释</h3>
<p>问题 <a href="http://stackoverflow.com/questions/2709821/python-self-explained">链接</a></p>
<p>self关键字的作用是什么？
我理解他用户在创建class时具体化实例，但我无法理解为何需要给每个方法加入self作为参数.</p>
<p>举例，在ruby中，我这么做:</p>
<div class="codehilite"><pre><span class="k">class</span> <span class="n">myClass</span>
    <span class="n">def</span> <span class="n">myFunc</span>(<span class="nb">name</span>)
        <span class="nv">@name</span> = <span class="nb">name</span>
    <span class="nb">end</span>
<span class="nb">end</span>
</pre></div>
<p>我可以很好地理解，非常简单.但是在Python中，我需要去加入self:</p>
<div class="codehilite"><pre><span class="k">class</span> <span class="n">myClass:</span>
    <span class="n">def</span> <span class="n">myFunc</span>(<span class="k">self</span>, <span class="nb">name</span>):
        <span class="k">self</span>.<span class="nb">name</span> = <span class="nb">name</span>
</pre></div>
<p>有谁能解释下么？</p>
<p>使用self关键字的原因是，Python没有@语法用于引用实例属性.Python决定用一种方式声明方法:实例对象自动传递给属于它的方法,但不是接收自动化：方法的第一个参数是调用这个方法的实例对象本身.这使得方法整个同函数一致,并且由你自己决定真实的名（虽然self是约定，但当你使用其他名的时候，通常人们并不乐意接受）.self对于代码不是特殊的，只是另一个对象.</p>
<p>Python本来可以做一些用来区分真实的名字和属性的区别 &mdash;&mdash; 像Ruby有的特殊语法，或者像C++/Java的命令声明,或者其他可能的的语法 &mdash;&mdash; 但是Python没有这么做.Python致力于使事情变得明确简单，让事情是其本身，虽然并不是全部地方都这么做，但是实例属性石这么做的！这就是为什么给一个实例属性赋值时需要知道是给哪个实例赋值,并且，这就是为什么需要self</p>
<p>举例</p>
<div class="codehilite"><pre><span class="k">class</span> <span class="n">Vector</span>(<span class="n">object</span>):
    <span class="n">def</span> <span class="n">__init__</span>(<span class="k">self</span>, <span class="o">x</span>, <span class="n">y</span>):
        <span class="k">self</span>.<span class="o">x</span> = <span class="o">x</span>
        <span class="k">self</span>.<span class="n">y</span> = <span class="n">y</span>
    <span class="n">def</span> <span class="n">length</span>(<span class="k">self</span>):
        <span class="k">return</span> <span class="n">math</span>.<span class="nb">sqrt</span>(<span class="k">self</span>.<span class="o">x</span> ** <span class="mi">2</span> + <span class="k">self</span>.<span class="n">y</span> ** <span class="mi">2</span>)
</pre></div>
<p>等价于</p>
<div class="codehilite"><pre>def length_global(vector):
    return math.sqrt(vector.x ** 2 + vector.y ** 2)
</pre></div>
<p>另外</p>
<div class="codehilite"><pre>v_instance.length()
转为
Vector.length(v_instance)
</pre></div>
<h3 id="pythonprivate">为什么Python的'private'方法并不是真正的私有方法</h3>
<p>问题 <a href="http://stackoverflow.com/questions/70528/why-are-pythons-private-methods-not-actually-private">链接</a></p>
<p>Python允许我们创建'private' 函数：变量以两个下划线开头，像这样： <em>__myPrivateMethod()</em>.
但是，如何解释：</p>
<div class="codehilite"><pre>&gt;&gt;&gt; class MyClass:
...     def myPublicMethod(self):
...             print 'public method'
...     def __myPrivateMethod(self):
...             print 'this is private!!'
...
&gt;&gt;&gt; obj = MyClass()
&gt;&gt;&gt; obj.myPublicMethod()
public method
&gt;&gt;&gt; obj.__myPrivateMethod()
Traceback (most recent call last):
File "", line 1, in
AttributeError: MyClass instance has no attribute '__myPrivateMethod'
&gt;&gt;&gt; dir(obj)
['_MyClass__myPrivateMethod', '__doc__', '__module__', 'myPublicMethod']
&gt;&gt;&gt; obj._MyClass__myPrivateMethod()
this is private!!
</pre></div>
<p>dir(obj) 和 obj._MyClass__myPrivateMethod()</p>
<p>回答</p>
<p>&lsquo;private'只是用作，确保子类不会意外覆写父类的私有方法和属性.不是为了保护外部意外访问而设计的！</p>
<p>例如:</p>
<div class="codehilite"><pre>&gt;&gt;&gt; class Foo(object):
...     def __init__(self):
...         self.__baz = 42
...     def foo(self):
...         print self.__baz
...
&gt;&gt;&gt; class Bar(Foo):
...     def __init__(self):
...         super(Bar, self).__init__()
...         self.__baz = 21
...     def bar(self):
...         print self.__baz
...
&gt;&gt;&gt; x = Bar()
&gt;&gt;&gt; x.foo()
42
&gt;&gt;&gt; x.bar()
21
&gt;&gt;&gt; print x.__dict__
{'_Bar__baz': 21, '_Foo__baz': 42}
</pre></div>
<p>当然，这对于两个同名的类没有作用</p>
<p>另外，可以查看diveintopython的解释 <a href="http://www.faqs.org/docs/diveintopython/fileinfo_private.html#d0e11521">入口</a></p>
<h3 id="python_11">Python中类方法的作用是什么</h3>
<p>问题 <a href="http://stackoverflow.com/questions/38238/what-are-class-methods-in-python-for">链接</a></p>
<p>我现在意识到，我不需要像我在使用java的static方法那样使用类方法，但是我不确定什么时候使用</p>
<p>谁能通过一个好的例子解释下Python中的类方法，至少有人能告诉我什么时候确实需要使用类方法</p>
<p>类方法用在：当你需要使用不属于任何明确实例的方法,但同时必须涉及类.有趣的是，你可以在子类中覆写，这在Java的static方法和Python的模块级别函数中是不可能做到的</p>
<p>如果你有一个MyClass, 并且一个模块级别函数操作MyClass(工厂，依赖注入桩等等), 声明一个类方法.然后这个类方法可以在子类中调用</p>
<h3 id="list_2">如何删除一个list中重复的值同时保证原有顺序</h3>
<p>问题 <a href="http://stackoverflow.com/questions/480214/how-do-you-remove-duplicates-from-a-list-in-python-whilst-preserving-order">链接</a></p>
<p>我是这么做的额</p>
<div class="codehilite"><pre>def uniq(input):
output = []
for x in input:
    if x not in output:
    output.append(x)
return output
</pre></div>
<p>有什么更好的方法？</p>
<p>你可以在这里找到一些可用的方法 <a href="http://www.peterbe.com/plog/uniqifiers-benchmark">入口</a></p>
<p>最快的一个</p>
<div class="codehilite"><pre>def f7(seq):
    seen = set()
    seen_add = seen.add
    return [ x for x in seq if x not in seen and not seen_add(x)]
</pre></div>
<p>如果你需要在同一个数据集中多次是哦那个这个方法，或许你可以使用ordered set处理 http://code.activestate.com/recipes/528878/</p>
<p>插入，删除和归属判断复杂度都是O(1)</p>
<h3 id="_54">有什么方法可以获取系统当前用户名么?</h3>
<p>问题 <a href="http://stackoverflow.com/questions/842059/is-there-a-portable-way-to-get-the-current-username-in-python">链接</a></p>
<p>至少在Linux和Windows下都可用.就像 os.getuid</p>
<div class="codehilite"><pre>&gt;&gt;&gt; os.getuid()
42
&gt;&gt;&gt; os.getusername()
'slartibartfast'
</pre></div>
<p>可以看看 <a href="http://docs.python.org/2/library/getpass.html">getpass</a> 模块</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">getpass</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">getpass</span><span class="o">.</span><span class="n">getuser</span><span class="p">()</span>
<span class="s1">'kostya'</span>
</pre></div>
<p>可用: Unix, Windows</p>
<h3 id="python-assert">Python assert最佳实践</h3>
<p>问题 <a href="http://stackoverflow.com/questions/944592/best-practice-for-python-assert">链接</a></p>
<p>有没有代码实例使用assert作为独立代码，而不是仅用来debug</p>
<div class="codehilite"><pre>assert x &gt;= 0, 'x is less than zero'

类似
if x &lt; 0:
    raise Exception, 'x is less than zero'

有什么方法，可以设定一个规则就像 if x \&lt; 0 抛出错误但是不是通过try/except/finally检查的
</pre></div>
<p>搞晕了：</p>
<div class="codehilite"><pre>原文 Also, is there any way to set a business rule like if x \&lt; 0 raise error that is always checked without the try/except/finally so, if at anytime throughout the code x is less than 0 an error is raised, like if you set assert x &lt; 0 at the start of a function, anywhere within the function where x becomes less then 0 an exception is raised?
</pre></div>
<p>回答</p>
<p>Assert仅用在，测试那些从不发生的情况！目的是让程序尽早失败</p>
<p>Exception用在，那些可以明确知道会发生的错误，并且建议总是创建自己的异常类</p>
<p>例如，你写一个函数从配置文件中读取配置放入字典，文件格式不正确抛出一个ConfigurationSyntaxError,同时你可以assert返回值非None</p>
<p>在你的例子中，如果x是通过用户接口或外部传递设置的，最好使用exception</p>
<p>如果x仅是同一个程序的内部代码，使用assert</p>
<h3 id="_55">在非创建全局变量的地方使用全局变量</h3>
<p>问题 <a href="http://stackoverflow.com/questions/423379/using-global-variables-in-a-function-other-than-the-one-that-created-them">链接</a></p>
<p>如果我在一个函数中创建了全局变量，如何在另一个函数中使用？</p>
<p>回答：</p>
<p>你可以在给全局变量赋值的函数中声明 global</p>
<div class="codehilite"><pre>globvar = 0

def set_globvar_to_one():
    global globvar    # Needed to modify global copy of globvar
    globvar = 1

def print_globvar():
    print globvar     # No need for global declaration to read value of globvar

set_globvar_to_one()
print_globvar()       # Prints 1
</pre></div>
<p>我猜想这么做的原因是，全局变量很危险，Python想要确保你真的知道你要对一个全局的变量进行操作</p>
<p>如果你想知道如何在模块间使用全局变量，查看其他回答</p>
<h3 id="python_12">如何在单一表达式中合并两个Python字典</h3>
<p>问题 <a href="http://stackoverflow.com/questions/38987/how-can-i-merge-union-two-python-dictionaries-in-a-single-expression">链接</a></p>
<div class="codehilite"><pre>&gt;&gt;&gt; x = {'a':1, 'b': 2}
&gt;&gt;&gt; y = {'b':10, 'c': 11}
&gt;&gt;&gt; z = x.update(y)
&gt;&gt;&gt; print z
None
&gt;&gt;&gt; x
{'a': 1, 'b': 10, 'c': 11}
</pre></div>
<p>我想要最终合并结果在z中，不是x，我要怎么做？</p>
<p>回答</p>
<p>这种情况下，可以使用</p>
<div class="codehilite"><pre>z = dict(x.items() + y.items())
</pre></div>
<p>这个表达式将会实现你想要的，最终结果z，并且相同key的值，将会是y中key对应的值</p>
<div class="codehilite"><pre>&gt;&gt;&gt; x = {'a':1, 'b': 2}
&gt;&gt;&gt; y = {'b':10, 'c': 11}
&gt;&gt;&gt; z = dict(x.items() + y.items())
&gt;&gt;&gt; z
{'a': 1, 'c': 11, 'b': 10}
</pre></div>
<p>如果在Python3中,会变得有些复杂</p>
<div class="codehilite"><pre>&gt;&gt;&gt; z = dict(list(x.items()) + list(y.items()))
&gt;&gt;&gt; z
{'a': 1, 'c': 11, 'b': 10}
</pre></div>
<h3 id="pip">如何使用 pip 更新所有包</h3>
<p>问题 <a href="http://stackoverflow.com/questions/2720014/upgrading-all-packages-with-pip">链接</a></p>
<p>如何使用pip更新python的所有包</p>
<p>没有内置的标志可以实现</p>
<p>但是你可以这么做</p>
<div class="codehilite"><pre>pip freeze --local | grep -v '^\-e' | cut -d = -f 1  | xargs pip install -U
</pre></div>
<h3 id="pythonexception">Python中声明exception的方法</h3>
<p>问题 <a href="http://stackoverflow.com/questions/1319615/proper-way-to-declare-custom-exceptions-in-modern-python">链接</a></p>
<p>在python2.6中定义异常得到警告</p>
<div class="codehilite"><pre>&gt;&gt;&gt; class MyError(Exception):
...     def __init__(self, message):
...         self.message = message
...
&gt;&gt;&gt; MyError("foo")
_sandbox.py:3: DeprecationWarning: BaseException.message has been deprecated as of Python 2.6
</pre></div>
<p>问题很长，大意如标题</p>
<p>回答</p>
<p>或许我理解错了，但是为什么不这样做</p>
<div class="codehilite"><pre><span class="k">class</span> <span class="n">MyException</span>(<span class="nb">Exception</span>):
    <span class="nb">pass</span>
</pre></div>
<p>如果要重写什么，例如传递额外参数，可以这么做</p>
<div class="codehilite"><pre><span class="k">class</span> <span class="n">ValidationError</span>(<span class="nb">Exception</span>):
    <span class="n">def</span> <span class="n">__init__</span>(<span class="k">self</span>, <span class="n">message</span>, <span class="n">Errors</span>):

        <span class="c c-Singleline"># Call the base class constructor with the parameters it needs</span>
        <span class="nb">Exception</span>.<span class="n">__init__</span>(<span class="k">self</span>, <span class="n">message</span>)

        <span class="c c-Singleline"># Now for your custom code...</span>
        <span class="k">self</span>.<span class="n">Errors</span> = <span class="n">Errors</span>
</pre></div>
<p>你可以通过第二个参数传递error 字典, 之后通过e.Errors获取</p>
<h3 id="pythoncounter">在Python中使用Counter错误</h3>
<p>问题 <a href="http://stackoverflow.com/questions/13311094/counter-in-collections-module-python">链接</a></p>
<p>当使用Counter时，出现异常</p>
<div class="codehilite"><pre><span class="ne">AttributeError</span><span class="p">:</span> <span class="s1">'module'</span> <span class="nb">object</span> <span class="n">has</span> <span class="n">no</span> <span class="n">attribute</span> <span class="s1">'Counter'</span>

<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
<span class="ne">ImportError</span><span class="p">:</span> <span class="n">cannot</span> <span class="kn">import</span> <span class="nn">name</span> <span class="nn">Counter</span>
</pre></div>
<p>原因：</p>
<p>版本问题，Counter在 python2.7中才被加入到这个模块，你可能使用了Python2.6或更老的版本</p>
<p>可以看下 <a href="http://docs.python.org/2/library/collections.html#collections.Counter">文档</a></p>
<p>如果要在 Python2.6或2.5版本使用，可以看 <a href="http://code.activestate.com/recipes/576611-counter-class/">这里</a></p>
<h3 id="python-easy_install">如何删除Python easy_install安装的包</h3>
<p>问题 <a href="http://stackoverflow.com/questions/1231688/how-do-i-remove-packages-installed-with-pythons-easy-install">链接</a></p>
<p><a href="https://pypi.python.org/pypi/pip/">pip</a>, setuptools/easy_install的另一种选择，提供uninstall命令</p>
<p>首先，移除依赖</p>
<div class="codehilite"><pre>$ easy_install -m <span class="o">[</span>PACKAGE<span class="o">]</span>
</pre></div>
<p>然后，手动删除egg文件</p>
<div class="codehilite"><pre>$ rm -rf .../python2.X/site-packages/<span class="o">[</span>PACKAGE<span class="o">]</span>.egg
</pre></div>
<h3 id="pythonxml">在Python中如何解析xml</h3>
<p>问题 <a href="http://stackoverflow.com/questions/1912434/how-do-i-parse-xml-in-python">链接</a></p>
<div class="codehilite"><pre><span class="nt">&lt;foo&gt;</span>
<span class="nt">&lt;bar&gt;</span>
    <span class="nt">&lt;type</span> <span class="na">foobar=</span><span class="s">"1"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;type</span> <span class="na">foobar=</span><span class="s">"2"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bar&gt;</span>
<span class="nt">&lt;/foo&gt;</span>
</pre></div>
<p>如何解析获取xml文件中内容</p>
<p>我建议使用 <a href="http://docs.python.org/2/library/xml.etree.elementtree.html">ElementTree</a> (有其他可用的实现，例如 <a href="http://lxml.de/">lxml</a>，他们只是更快, ElementTree提供更简单的编程api)</p>
<p>在使用XML建立Element实例之后，例如使用 <a href="http://docs.python.org/2/library/xml.etree.elementtree.html#xml.etree.ElementTree.XML">XML</a> 函数</p>
<div class="codehilite"><pre>for atype in e.findall('type')
    print(atype.get('foobar'))
</pre></div>
<h3 id="python-timestruct_timedatetime">如何将一个Python time.struct_time对象转换为一个datetime对象</h3>
<p>问题 <a href="http://stackoverflow.com/questions/1697815/how-do-you-convert-a-python-time-struct-time-object-into-a-datetime-object">链接</a></p>
<p>使用 <a href="">time.mktime()</a> 将time元组(本地时间)转成秒， 然后使用 datetime.fromtimestamp() 转成datetime对象</p>
<div class="codehilite"><pre><span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">mktime</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="n">dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">mktime</span><span class="p">(</span><span class="n">struct</span><span class="p">))</span>
</pre></div>
    </section>

    <section id="copyright">
        <div class="copyright">
            版权声明：自由转载-非商用-非衍生-保持署名 | <a href="http://creativecommons.org/licenses/by-nc-nd/3.0/deed.zh" target="_blank" >Creative Commons BY-NC-ND 3.0</a>
        </div>

        <div class="donation">
            <center>
            <img src="/imgs/life/donation.png"/>
            <strong> 如果你觉得我的文章或项目对你有所帮助, 可小额捐赠 ¥0.99/¥2.99/¥4.99/¥9.9 用于站点域名及主机维护:)</strong>
            </center>
        </div>
    </section>


    <section id="neighbors">
        <div>
                        <a class="left" href="http://www.wklken.me/posts/2013/07/19/python-translate-decorator.html">
                            上一篇:  [翻译]理解python中的装饰器
                        </a>
                        <a class="right" href="http://www.wklken.me/posts/2013/08/04/translation-vim-introduction-and-tutorial.html">
                            下一篇: [翻译]vim入门指南
                        </a>
        </div>
    </section>

    <section id="ad">
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <!-- blog_ad_001 -->
        <ins class="adsbygoogle"
            style="display:block"
            data-ad-client="ca-pub-7635941258020589"
            data-ad-slot="3455159758"
            data-ad-format="auto"></ins>
        <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
    </section>



<section id="comments">
        <div class="comments">
            <div id="disqus_thread"></div>
            <script type="text/javascript">
                var disqus_identifier = "posts/2013/07/20/python-stackoverflow-vote-top.html";
                (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = 'http://wklken.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
            </div>
</section>



</article>
        </section><!--end #main-->

            <footer class="row">
                <div class="large-12 columns">
                    <p>
                            Copyright © 2015 wklken <br>
                            Hosted on <a href="http://www.vultr.com/?ref=6847203"> vultr </a> Also <a href="https://www.digitalocean.com/?refcode=8ee73f2c47ce"> DigitalOcean </a>. Powered by <a href="http://alexis.notmyidea.org/pelican/">pelican</a>. Social Icons by <a href="http://fortawesome.github.io/Font-Awesome/">Font-Awesome</a>.
                    </p>
                </div>
            </footer>

            </div>
        </div>

        <section id="extras" class="body">
        </section><!-- /#extras -->



<script src="http://apps.bdimg.com/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="http://apps.bdimg.com/libs/jquery-scrollUp/2.1.0/jquery.scrollUp.min.js"></script>
<script src="http://apps.bdimg.com/libs/jqueryui/1.10.4/jquery-ui.min.js"></script>
<script>
    $(function(){
        $.scrollUp({
              scrollText: '', // Text for element, can contain HTML
            });
    });
</script>


<script type="text/javascript">
  /* var Swiftype = window.Swiftype || {}; */
  /* Swiftype.searchSearchFields = { */
    /* "page": ["title^10", "body"] */
  /* }; */

  /* (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){ */
  /* (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t); */
  /* e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e); */
  /* })(window,document,'script','//s.swiftypecdn.com/install/v1/st.js','_st'); */

  /* _st('install','v6K-_DamCeHvwX6z3o2F'); */
</script>



    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
        var pageTracker = _gat._getTracker("UA-42275748-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>




<div id="share">
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"1","bdMiniList":["mshare","tsina","weixin","douban","meilishuo","mogujie","youdao","sdo","mail","twi","copy","print"],"bdPic":"","bdStyle":"0","bdSize":"16"},"slide":{"type":"slide","bdImg":"5","bdPos":"right","bdTop":"96.5"}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>
</div>



<script  src="http://www.wklken.me/theme/js/scroll-header.js" type="text/javascript"></script>




</body>
</html>